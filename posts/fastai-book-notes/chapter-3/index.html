<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Christian Mills">
<meta name="dcterms.date" content="2022-03-14">
<meta name="description" content="Chapter 3 defines data ethics, introduces essential topics in data ethics, and explains how to identify and address ethical issues.">

<title>Christian Mills - Notes on fastai Book Ch. 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Christian Mills - Notes on fastai Book Ch. 3">
<meta property="og:description" content="Chapter 3 defines data ethics, introduces essential topics in data ethics, and explains how to identify and address ethical issues.">
<meta property="og:image" content="christianjmills.com/posts/fastai-book-notes/chapter-3/images/logo.png">
<meta property="og:site_name" content="Christian Mills">
<meta name="twitter:title" content="Christian Mills - Notes on fastai Book Ch. 3">
<meta name="twitter:description" content="Chapter 3 defines data ethics, introduces essential topics in data ethics, and explains how to identify and address ethical issues.">
<meta name="twitter:image" content="christianjmills.com/posts/fastai-book-notes/chapter-3/images/logo.png">
<meta name="twitter:creator" content="@cdotjdotmills">
<meta name="twitter:site" content="@cdotjdotmills">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Christian Mills</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../series/tutorials/index.html"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../series/notes/index.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../services.html"> 
<span class="menu-text">Services</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:christian@christianjmills.com"> <i class="bi bi-envelope-fill" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/cj-mills"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/cdotjdotmills"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-ethics" id="toc-data-ethics" class="nav-link active" data-scroll-target="#data-ethics">Data Ethics</a>
  <ul>
  <li><a href="#ethics" id="toc-ethics" class="nav-link" data-scroll-target="#ethics">Ethics</a></li>
  <li><a href="#what-is-data-ethics" id="toc-what-is-data-ethics" class="nav-link" data-scroll-target="#what-is-data-ethics">What is Data Ethics?</a></li>
  </ul></li>
  <li><a href="#key-examples-for-data-ethics" id="toc-key-examples-for-data-ethics" class="nav-link" data-scroll-target="#key-examples-for-data-ethics">Key Examples for Data Ethics</a>
  <ul>
  <li><a href="#bugs-and-recourse-buggy-algorithm-used-for-healthcare-benefits" id="toc-bugs-and-recourse-buggy-algorithm-used-for-healthcare-benefits" class="nav-link" data-scroll-target="#bugs-and-recourse-buggy-algorithm-used-for-healthcare-benefits">Bugs and Recourse: Buggy Algorithm Used for Healthcare Benefits</a></li>
  <li><a href="#feedback-loops-youtubes-recommendation-system" id="toc-feedback-loops-youtubes-recommendation-system" class="nav-link" data-scroll-target="#feedback-loops-youtubes-recommendation-system">Feedback Loops: YouTube’s Recommendation System</a></li>
  <li><a href="#bias-professor-layanya-sweeney-arrested" id="toc-bias-professor-layanya-sweeney-arrested" class="nav-link" data-scroll-target="#bias-professor-layanya-sweeney-arrested">Bias: Professor Layanya Sweeney “Arrested”</a></li>
  <li><a href="#why-does-this-matter" id="toc-why-does-this-matter" class="nav-link" data-scroll-target="#why-does-this-matter">Why Does This Matter?</a></li>
  </ul></li>
  <li><a href="#integrating-machine-learning-with-product-design" id="toc-integrating-machine-learning-with-product-design" class="nav-link" data-scroll-target="#integrating-machine-learning-with-product-design">Integrating Machine Learning with Product Design</a></li>
  <li><a href="#topics-in-data-ethics" id="toc-topics-in-data-ethics" class="nav-link" data-scroll-target="#topics-in-data-ethics">Topics in Data Ethics</a>
  <ul>
  <li><a href="#recourse-and-accountability" id="toc-recourse-and-accountability" class="nav-link" data-scroll-target="#recourse-and-accountability">Recourse and Accountability</a></li>
  <li><a href="#feedback-loops" id="toc-feedback-loops" class="nav-link" data-scroll-target="#feedback-loops">Feedback Loops</a></li>
  <li><a href="#bias" id="toc-bias" class="nav-link" data-scroll-target="#bias">Bias</a></li>
  <li><a href="#addressing-different-types-of-bias" id="toc-addressing-different-types-of-bias" class="nav-link" data-scroll-target="#addressing-different-types-of-bias">Addressing different types of bias</a></li>
  <li><a href="#disinformation" id="toc-disinformation" class="nav-link" data-scroll-target="#disinformation">Disinformation</a></li>
  </ul></li>
  <li><a href="#identifying-and-addressing-ethical-issues" id="toc-identifying-and-addressing-ethical-issues" class="nav-link" data-scroll-target="#identifying-and-addressing-ethical-issues">Identifying and Addressing Ethical Issues</a>
  <ul>
  <li><a href="#analyze-a-project-you-are-working-on" id="toc-analyze-a-project-you-are-working-on" class="nav-link" data-scroll-target="#analyze-a-project-you-are-working-on">Analyze a Project You Are Working On</a></li>
  <li><a href="#implement-processes-at-your-company-to-find-and-address-ethical-risks" id="toc-implement-processes-at-your-company-to-find-and-address-ethical-risks" class="nav-link" data-scroll-target="#implement-processes-at-your-company-to-find-and-address-ethical-risks">Implement processes at your company to find and address ethical risks</a></li>
  <li><a href="#the-power-of-diversity" id="toc-the-power-of-diversity" class="nav-link" data-scroll-target="#the-power-of-diversity">The Power of Diversity</a></li>
  <li><a href="#fairness-accountability-and-transparency" id="toc-fairness-accountability-and-transparency" class="nav-link" data-scroll-target="#fairness-accountability-and-transparency">Fairness, Accountability, and Transparency</a></li>
  </ul></li>
  <li><a href="#role-of-policy" id="toc-role-of-policy" class="nav-link" data-scroll-target="#role-of-policy">Role of Policy</a>
  <ul>
  <li><a href="#the-effectiveness-of-regulation" id="toc-the-effectiveness-of-regulation" class="nav-link" data-scroll-target="#the-effectiveness-of-regulation">The Effectiveness of Regulation</a></li>
  <li><a href="#rights-and-policy" id="toc-rights-and-policy" class="nav-link" data-scroll-target="#rights-and-policy">Rights and Policy</a></li>
  <li><a href="#cars-a-historical-precedent" id="toc-cars-a-historical-precedent" class="nav-link" data-scroll-target="#cars-a-historical-precedent">Cars: A Historical Precedent</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Notes on fastai Book Ch. 3</h1>
  <div class="quarto-categories">
    <div class="quarto-category">ai</div>
    <div class="quarto-category">ethics</div>
    <div class="quarto-category">fastai</div>
    <div class="quarto-category">notes</div>
  </div>
  </div>

<div>
  <div class="description">
    Chapter 3 defines data ethics, introduces essential topics in data ethics, and explains how to identify and address ethical issues.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Christian Mills </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 14, 2022</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
This post is part of the following series:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="../../../series/notes/fastai-book-notes.html"><strong>Deep Learning for Coders with fastai &amp; PyTorch</strong></a></li>
</ul>
</div>
</div>
<ul>
<li><a href="#data-ethics">Data Ethics</a></li>
<li><a href="#key-examples-for-data-ethics">Key Examples for Data Ethics</a></li>
<li><a href="#integrating-machine-learning-with-product-design">Integrating Machine Learning with Product Design</a></li>
<li><a href="#topics-in-data-ethics">Topics in Data Ethics</a></li>
<li><a href="#identifying-and-addressing-ethical-issues">Identifying and Addressing Ethical Issues</a></li>
<li><a href="#role-of-policy">Role of Policy</a></li>
<li><a href="#references">References</a></li>
</ul>
<section id="data-ethics" class="level2">
<h2 class="anchored" data-anchor-id="data-ethics">Data Ethics</h2>
<ul>
<li>Sometimes machine learning models can go wrong
<ul>
<li>the can have bugs</li>
<li>they can be presented with data that they have not seen before and behave in ways we don’t expect</li>
<li>they can work exactly as designed but be used for malicious purposes</li>
</ul></li>
<li>the power of deep learning makes it important for us to consider the consequences of our choices</li>
</ul>
<section id="ethics" class="level3">
<h3 class="anchored" data-anchor-id="ethics">Ethics</h3>
<ul>
<li>the philosophical study of right and wrong, including how we can define those terms, reognize right and wrong actions, and understand the connection between actions and consequences</li>
<li>no one really agrees on what right and wrong are, whether they exist, how to spot them, which people are good and bad, etc.</li>
<li><a href="https://www.scu.edu/ethics/ethics-resources/ethical-decision-making/what-is-ethics/">What is Ethics?</a> by Markkula Center for Applied Ethics
<ul>
<li>the term ethics refers to
<ul>
<li>Well-founded standards of right and wrong that prescribe what humans should do</li>
<li>The study and development of one’s ethical standards</li>
</ul></li>
</ul></li>
<li>ethics is complicated and context-dependent</li>
<li>involves the perspectives of many stakeholders</li>
</ul>
</section>
<section id="what-is-data-ethics" class="level3">
<h3 class="anchored" data-anchor-id="what-is-data-ethics">What is Data Ethics?</h3>
<ul>
<li><p>a subfiled of ethics</p></li>
<li><p>being used to define policy in many jurisdictions</p></li>
<li><p>being used in companies to consider how best to ensure good societal outcomes from product development</p></li>
<li><p>being used by researchers who want to make sure the work they are doing is used for good</p></li>
<li><p>deep learning practitioners will likely face situations where they need to consider data ethics</p></li>
</ul>
</section>
</section>
<section id="key-examples-for-data-ethics" class="level2">
<h2 class="anchored" data-anchor-id="key-examples-for-data-ethics">Key Examples for Data Ethics</h2>
<section id="bugs-and-recourse-buggy-algorithm-used-for-healthcare-benefits" class="level3">
<h3 class="anchored" data-anchor-id="bugs-and-recourse-buggy-algorithm-used-for-healthcare-benefits">Bugs and Recourse: Buggy Algorithm Used for Healthcare Benefits</h3>
<ul>
<li>Akansas’s buggy healthcare system left patients stranded</li>
<li><a href="https://www.theverge.com/2018/3/21/17144260/healthcare-medicaid-algorithm-arkansas-cerebral-palsy">What happens when an algorithm cuts your health care</a>
<ul>
<li>The Verge investigated software used in over half of the US states to determine how much healthcare people receive</li>
<li>hundreds of people, many with severe disabilities, had their healthcare drastically cut.
<ul>
<li>a woman with cerebral-palsy how needs constant assistance had her hours of help suddenly reduced by 20 hours per week
<ul>
<li>she could not get any explanation for why</li>
<li>a court case revealed there were mistakes made in the software implementation of the algorithm</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="feedback-loops-youtubes-recommendation-system" class="level3">
<h3 class="anchored" data-anchor-id="feedback-loops-youtubes-recommendation-system">Feedback Loops: YouTube’s Recommendation System</h3>
<ul>
<li>feedback loops can occur when your model is influences future input data</li>
<li>YouTube’s recommendation system helped unleash a conspiracy theory boom
<ul>
<li>The algorithm was designed to optimize watch time</li>
<li>responsible for 70% of the content that is watched</li>
</ul></li>
<li><a href="https://www.nytimes.com/2019/02/19/technology/youtube-conspiracy-stars.html">YouTube Unleashed a Conspiracy Theory Boom. Can It Be Contained?</a></li>
<li>recommendation systems have a lot of power over what people see</li>
</ul>
</section>
<section id="bias-professor-layanya-sweeney-arrested" class="level3">
<h3 class="anchored" data-anchor-id="bias-professor-layanya-sweeney-arrested">Bias: Professor Layanya Sweeney “Arrested”</h3>
<ul>
<li>When a traditionally African American name is searched for on Google, is displays ads for criminal background checks</li>
<li>Dr.&nbsp;Latanya Sweeney is a professor at Harvard and director of the university’s data privacy lab
<ul>
<li>discovered that Googling her name resulted in adverstisements saying “Latanya Sweeney Arrested?”, despite being the only Latanya Sweeney and never having been arrested</li>
<li>discovered that historically Black names received advertisements suggesting the person had a criminal record</li>
</ul></li>
</ul>
</section>
<section id="why-does-this-matter" class="level3">
<h3 class="anchored" data-anchor-id="why-does-this-matter">Why Does This Matter?</h3>
<ul>
<li>everybody who is training models needs to consider how their models will be used and consider how to ensure they are used positively
<ul>
<li>How would you feel if you discovered that you had been part of system that ended up hurting society?
<ul>
<li>Would you be open to finding out?</li>
<li>How can you help make sure this doesn’t happen?</li>
</ul></li>
</ul></li>
<li>IBM and Nazi Germany
<ul>
<li><a href="https://www.dialogpress.com/books/ibm-and-holocaust">IBM and the Holocaust</a> by Edwin Black
<ul>
<li>“To the blind technocrat, the means were more important than the ends. The destruction of the Jewish people became even less important because the invigorating nature of IBM’s technical achievement was only heightened by the fantastical profits to be made at a time when bread lines stretched across the world.”</li>
</ul></li>
<li>IBM supplied the Nazis with the data tabulation products used to track the extermination of Jews and other groups on a massive scale
<ul>
<li>This was drive from the top of the company, with marketing to Hitler and his leadership team</li>
<li>Company President Thomas Watson personally approved the 1939 release of special IBM alphabetizing machines to help organize the deportation of Polish Jews</li>
<li>Hitler awared Company President Thomas Watson with a special “Service to the Reich” medal in 1937</li>
<li>IBM and its subsidiaries provied regular training and maintenance onsite at the concentration camps
<ul>
<li>printing off cards</li>
<li>configuring machines</li>
<li>repariing machines</li>
</ul></li>
<li>IBM set up categorizations on its punch card system for
<ul>
<li>the way each person was killed</li>
<li>whic group they were assigned to</li>
<li>the logistical information necessary to track them through the vast Holocaust system</li>
</ul></li>
</ul></li>
</ul></li>
<li>Volkswagen Diesel Scandal
<ul>
<li>the care company was revealed to have cheated on its diesel emissions tests</li>
<li>the first person who was jailed was one of the engineers who just did what he was told</li>
</ul></li>
<li>Data scientists need to consider the entire pipeline of steps that occurs between the development of a model and the point at which the model is used to make a decision
<ul>
<li>inform everyone involved in this chain about the capabilities, constraints, and details of your work</li>
<li>make sure the right issues are being considered</li>
</ul></li>
<li>need to know when to refuse to do a piece of work</li>
</ul>
</section>
</section>
<section id="integrating-machine-learning-with-product-design" class="level2">
<h2 class="anchored" data-anchor-id="integrating-machine-learning-with-product-design">Integrating Machine Learning with Product Design</h2>
<ul>
<li>Lots of decisions are involved when collecting your data and developing your model
<ul>
<li>What level of aggregation will you store your data at?</li>
<li>What loss function should you use?</li>
<li>What validation and training sets should you use?</li>
<li>Should you focus on simplicity of implementation, speed of inference, or accuracy of the model?</li>
<li>How will your model handle out-of-domain data items?</li>
<li>Can it be fine-tuned, or must it be retrained from scratch over time?</li>
</ul></li>
<li>Whoever ends up developing and using the system that implements your model will not be well-placed to understand the decisions you made when training the model</li>
<li>Data scientists need to be part of a tightly integrated, cross-disciplinary team</li>
<li>Researchers need to work closely with the kinds of people who will end up using their research.</li>
<li>Ideally, domain experts should learn enough to be able to train and debug some models themselves</li>
</ul>
</section>
<section id="topics-in-data-ethics" class="level2">
<h2 class="anchored" data-anchor-id="topics-in-data-ethics">Topics in Data Ethics</h2>
<section id="recourse-and-accountability" class="level3">
<h3 class="anchored" data-anchor-id="recourse-and-accountability">Recourse and Accountability</h3>
<ul>
<li>a lack of responsibility and accountability leads to bad results</li>
<li>mechanisms for data audits and error corrections are crucial
<ul>
<li>data often contains errors</li>
</ul></li>
<li>machine learning practitioners have a responsibility to understand how their algorithms end up being implemented in practice</li>
</ul>
</section>
<section id="feedback-loops" class="level3">
<h3 class="anchored" data-anchor-id="feedback-loops">Feedback Loops</h3>
<ul>
<li>be aware of the centrality of metrics in driving a fincancially important system
<ul>
<li>an algorithm will do everything it can to optimize a target metric
<ul>
<li>can lead to unforeseen edge cases</li>
<li>humans ineracting with a system will search for, find, and exploit these edge cases and feedback loops for their advantage</li>
</ul></li>
<li>transparancy is important for uncovering problems</li>
</ul></li>
<li>there can also be feedback loops without humans</li>
<li>consider what data features and metrics might lead to feedback loops
<ul>
<li>the most optimal algorithm might not be the best one to deploy to production</li>
</ul></li>
<li>have mechanisms in place to spot runaway feedback loops and tak positive steps to break them when they occur</li>
</ul>
</section>
<section id="bias" class="level3">
<h3 class="anchored" data-anchor-id="bias">Bias</h3>
<ul>
<li><a href="https://arxiv.org/abs/1901.10002">A Framework for Understanding Sources of Harm throughout the Machine Learning Life Cycle</a></li>
<li>Six Types of Bias in Machine Learning
<ol type="1">
<li>Historical Bias
<ul>
<li>bias from people, processes, and society</li>
<li>historical bias is a fundamental, structural issue with the first step of the data generation process</li>
<li>can exist even given perfect sampling and feature selection</li>
<li>any dataset involving humans can have historical bias
<ul>
<li>medical data</li>
<li>sales data</li>
<li>housing data</li>
<li>political data</li>
</ul></li>
<li>fixing problems in machine learning systems is hard when the input data has problems</li>
<li>under representation of certain groups in the training data can result in a model that performs worse for those subgroups
<ul>
<li><a href="https://arxiv.org/abs/1711.08536">No Classification without Representation: Assessing Geodiversity Issues in Open Data Sets for the Developing World</a>
<ul>
<li>the vast majority of images in popular benchmark datasets like ImageNet were found to be from the US and other Western countries</li>
</ul></li>
<li><a href="https://arxiv.org/abs/1906.02659">Does Object Recognition Work for Everyone?</a>
<ul>
<li>object recognition models trained on popular benckmark datasets performed poorly on items from lower-income countries</li>
</ul></li>
</ul></li>
</ul></li>
<li>Representation Bias
<ul>
<li><a href="https://arxiv.org/abs/1901.09451">Bias in Bios: A Case Study of Semantic Representation Bias in a High-Stakes Setting</a></li>
<li>models can not only reflect representation imbalances, but also amplify them</li>
</ul></li>
<li>Measurement Bias
<ul>
<li>bias from measuring the wrong thing, measuring something in the wrong way, or incorporating a measurement into the model innapropriately</li>
<li><a href="https://scholar.harvard.edu/files/sendhil/files/aer.p20171084.pdf">Does Machine Learning Automate Moral Hazard and Error?</a></li>
</ul></li>
<li>Aggregation Bias
<ul>
<li>occurs when models do not aggregate data in a way that incorporates all of the appropriate factors, or when a model does not include the necessary interactions terms, nonlinearities, or so forth</li>
<li>likely to occur in medical settings</li>
</ul></li>
<li>Evaluation Bias</li>
<li>Deployment Bias</li>
</ol></li>
</ul>
</section>
<section id="addressing-different-types-of-bias" class="level3">
<h3 class="anchored" data-anchor-id="addressing-different-types-of-bias">Addressing different types of bias</h3>
<ul>
<li>different types of bias require different approaches for mitigations</li>
<li>Create better documentation
<ul>
<li>decisions</li>
<li>context</li>
<li>specifics about how and why a particular dataset was created</li>
<li>what scenerios it is appropriate to use in</li>
<li>what the limitations are</li>
</ul></li>
<li>Algorithms are used differently than human decision makers
<ul>
<li>in practice, machine learning is often implemented because it is cheaper and more efficient, not because it leads to better outcomes</li>
<li><a href="https://www.penguinrandomhouse.com/books/241363/weapons-of-math-destruction-by-cathy-oneil/">Weapons of Math Destruction</a>
<ul>
<li>describes a pattern in which the priviledged are processed by people, whereas the poor are processed by algorithms</li>
</ul></li>
<li>People are more likely to assume algorithms are objective or error-free</li>
<li>Algorithms are more likely to be implemented with no appeals process in place</li>
<li>Algorithms are often used at scale</li>
<li>Algorithmic systems are often cheap</li>
</ul></li>
</ul>
</section>
<section id="disinformation" class="level3">
<h3 class="anchored" data-anchor-id="disinformation">Disinformation</h3>
<ul>
<li>often used to sow disharmony and uncertainty, and to get people to give up on seeking the truth
<ul>
<li>receiving conflicting accounts can lead people to assume they can’t trust anyting</li>
</ul></li>
<li>often contains seeds of truth, or half truths taken out of context</li>
<li>Most propaganda campaigns are a carefully designed mixture of facts, half-truths, exagerrations, and deliberate lies.
<ul>
<li><a href="https://www.houstonchronicle.com/local/gray-matters/article/A-Houston-protest-organized-by-Russian-trolls-12625481.php">A Houston protest, organized by Russian trolls</a></li>
</ul></li>
<li>often involves coordinated campaigns of inauthentic behavior
<ul>
<li>fraufulent accounts may try to make it seem like many people hold a particular viewpoint</li>
</ul></li>
<li>disinformation through autogenerated texsst is a significant issue enabled by deep learning models</li>
<li>one proposed solution is to develope some form of digital signiture</li>
<li><a href="https://hbr.org/2019/03/how-will-we-prevent-ai-based-forgery">How Will We Prevent AI-Based Forgery?</a>
<ul>
<li>“AI is poised to make high-fidelity forgery inexpensive and automated, leading to potentially disastrous consequences for democracy, security, and society.”</li>
</ul></li>
</ul>
</section>
</section>
<section id="identifying-and-addressing-ethical-issues" class="level2">
<h2 class="anchored" data-anchor-id="identifying-and-addressing-ethical-issues">Identifying and Addressing Ethical Issues</h2>
<ul>
<li>make finding and dealing with mistakes part of the design of any system that includes machine learning</li>
</ul>
<section id="analyze-a-project-you-are-working-on" class="level3">
<h3 class="anchored" data-anchor-id="analyze-a-project-you-are-working-on">Analyze a Project You Are Working On</h3>
<ul>
<li>Should we even be doing this?</li>
<li>What bias is in the data?</li>
<li>Can the code be audited?</li>
<li>What are the error rates for different subgroups?</li>
<li>What is the accuracy of a simple rule-based alternative?</li>
<li>What processes are in place to handle appeals or mistakes?</li>
<li>How diverse is the team that built it?</li>
<li>What data are you collecting and storing?
<ul>
<li>data often ends up being used for different purposes than the original intent
<ul>
<li>census data has been used to target minorities</li>
<li><a href="https://www.nytimes.com/2019/04/10/opinion/sunday/privacy-capitalism.html">How Capitalism Betrayed Privacy</a></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="implement-processes-at-your-company-to-find-and-address-ethical-risks" class="level3">
<h3 class="anchored" data-anchor-id="implement-processes-at-your-company-to-find-and-address-ethical-risks">Implement processes at your company to find and address ethical risks</h3>
<ul>
<li><a href="https://www.scu.edu/ethics-in-technology-practice/ethical-toolkit/">An Ethical Toolkit for Engineering/Design Practice</a>
<ul>
<li>includes concrete practices to implement at your company
<ul>
<li>regularly scheduled sweeps to proactively search for ethical risks</li>
<li>expanding the ethical circle to include the perspectives of a variety of stakeholders</li>
<li>considering how bad actors can abuse, steal, misinterpret, hack, destroy, or weaponize what your are building</li>
</ul></li>
<li>Whose interests, desires, skills, experiences, and values have we simply assumed, rather than actually consulted?</li>
<li>Who are all the stakeholders who will be directly affected by our product? How have their interests been protected? How do we know what their interests really are?</li>
<li>Who/which groups and individuals will be indirectly affected in significant ways?</li>
<li>Who might use this product the we did not expect to use it, or for purposes we did not initially intend?</li>
</ul></li>
</ul>
<p><strong>Ethical lenses</strong></p>
<ul>
<li>different foundational ethical lenses can help identify concrete issues</li>
<li>The rights approach
<ul>
<li>Which option best respects the rights of all who have a stake?</li>
</ul></li>
<li>The justics approach
<ul>
<li>Which option treats people equally or proportionately?</li>
</ul></li>
<li>The utilitarian approach
<ul>
<li>Which option will produce the most good and do the least harm?</li>
</ul></li>
<li>The common good approach
<ul>
<li>Which option best serves the community as a whole, not just some members?</li>
</ul></li>
<li>The virtue approach
<ul>
<li>Which option leads me to act as the sort of person I want to be?</li>
</ul></li>
<li>Consquences
<ul>
<li>Who will be directly affected bt this project? Who will be indirectly affected?</li>
<li>Will the effects in aggregate likely create more good than harm, and what types of good and harm?</li>
<li>Are we thinking about all relevant types of harm/benefit?</li>
<li>How might future generations be affected by this project?</li>
<li>Do the risks of harm from this project fall disproportionately on the least powerful? Will the benefits go disproportionately go to the well-off?</li>
<li>Have we adequately considered “dual-use” and unintended downstream effects?</li>
</ul></li>
<li>Deontological perspective
<ul>
<li>What rights of other and duties to others must we respect?</li>
<li>How might the dignity and autonomy of each stakeholder be impacted by this project?</li>
<li>What considerations of trust and of justice are relevant to this design/project?</li>
<li>Does this project involve any conflicting moral duties to other, or conflicting stakeholder rights? Howe can we prioritize these?</li>
</ul></li>
</ul>
</section>
<section id="the-power-of-diversity" class="level3">
<h3 class="anchored" data-anchor-id="the-power-of-diversity">The Power of Diversity</h3>
<ul>
<li>team members from similar backgrounds are likely to have similar blindspots around ethical risks</li>
<li>diversity can lead to problems being identified earlie and a wider range of solutions being considered</li>
</ul>
</section>
<section id="fairness-accountability-and-transparency" class="level3">
<h3 class="anchored" data-anchor-id="fairness-accountability-and-transparency">Fairness, Accountability, and Transparency</h3>
<ul>
<li><a href="https://fairmlbook.org/">Fairness and machine learning</a> book
<ul>
<li>gives a perspective on machine learning that treats fairness as a central concern rather than an afterthought</li>
</ul></li>
<li>Exercise
<ol type="1">
<li>Come up with a process, definition, set of questions, etc. which is designed to resolve a problem</li>
<li>Try to come up with an example in which that apparant solution results in a proposal that no one would consider acceptable</li>
<li>This can then lead to further refinement of the solution</li>
</ol></li>
</ul>
</section>
</section>
<section id="role-of-policy" class="level2">
<h2 class="anchored" data-anchor-id="role-of-policy">Role of Policy</h2>
<ul>
<li>purely technical solutions are not sufficient to address the underlying problems that have led to our current state.
<ul>
<li>as long as it is profitable to create addictive technology, companies will continue to do so</li>
</ul></li>
</ul>
<section id="the-effectiveness-of-regulation" class="level3">
<h3 class="anchored" data-anchor-id="the-effectiveness-of-regulation">The Effectiveness of Regulation</h3>
<ul>
<li>corporations are more reactive to the threat of significant financial penalty than to the systematic destruction of an ethnic minority</li>
</ul>
</section>
<section id="rights-and-policy" class="level3">
<h3 class="anchored" data-anchor-id="rights-and-policy">Rights and Policy</h3>
<ul>
<li>many harms resulting from unintended consequences of misuses of technology involve public goods, such as a polluted information environment or deteriorated ambient privacy</li>
<li>there are societal impacts to widespread survilance</li>
<li>human rights issues need to be addressed through law</li>
</ul>
</section>
<section id="cars-a-historical-precedent" class="level3">
<h3 class="anchored" data-anchor-id="cars-a-historical-precedent">Cars: A Historical Precedent</h3>
<ul>
<li>The movement to increase car safety sets a historical precedent for addressing problems in data ethics</li>
<li><a href="https://arxiv.org/abs/1803.09010">Datasheets for Datasets</a></li>
<li><a href="https://99percentinvisible.org/episode/nut-behind-wheel/">The Nut Behind the Wheel</a></li>
</ul>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li><a href="https://www.oreilly.com/library/view/deep-learning-for/9781492045519/">Deep Learning for Coders with fastai &amp; PyTorch</a></li>
<li><a href="https://github.com/fastai/fastbook">The fastai book GitHub Repository</a></li>
</ul>
<p><strong>Previous:</strong> <a href="../chapter-2/">Notes on fastai Book Ch. 2</a></p>
<p><strong>Next:</strong> <a href="../chapter-4/">Notes on fastai Book Ch. 4</a></p>


</section>

</main> <!-- /main -->
<!-- Cloudflare Web Analytics --><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;56b8d2f624604c4891327b3c0d9f6703&quot;}"></script><!-- End Cloudflare Web Analytics -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="cj-mills/christianjmills" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Copyright 2024, Christian J. Mills
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>