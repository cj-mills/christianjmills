<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Christian Mills">
<meta name="dcterms.date" content="2022-03-14">
<meta name="description" content="Chapter 1 covers the history of artificial neural networks, approaches for learning ML/DL, and using the fast.ai library for multiple deep learning tasks.">

<title>Notes on fastai Book Ch. 1 – Christian Mills</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-07ba0ad10f5680c660e360ac31d2f3b6.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-8b864f0777c60eecff11d75b6b2e1175.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-61f2d351c58b11e1d25c66c489878dfa.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark-fb8cbff63e0d11b0ded76255c6f80362.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Notes on fastai Book Ch. 1 – Christian Mills">
<meta property="og:description" content="Chapter 1 covers the history of artificial neural networks, approaches for learning ML/DL, and using the fast.ai library for multiple deep learning tasks.">
<meta property="og:image" content="https://christianjmills.com/images/default-preview-image-black.png">
<meta property="og:site_name" content="Christian Mills">
<meta property="og:image:height" content="284">
<meta property="og:image:width" content="526">
<meta name="twitter:title" content="Notes on fastai Book Ch. 1 – Christian Mills">
<meta name="twitter:description" content="Chapter 1 covers the history of artificial neural networks, approaches for learning ML/DL, and using the fast.ai library for multiple deep learning tasks.">
<meta name="twitter:image" content="https://christianjmills.com/images/default-preview-image-black.png">
<meta name="twitter:creator" content="@cdotjdotmills">
<meta name="twitter:site" content="@cdotjdotmills">
<meta name="twitter:image-height" content="284">
<meta name="twitter:image-width" content="526">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Christian Mills</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../series/tutorials/index.html"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../series/notes/index.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:christian@christianjmills.com"> <i class="bi bi-envelope-fill" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/cj-mills"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/cdotjdotmills"> <i class="bi bi-twitter-x" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/christianjmills"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#a-brief-history-of-neural-networks" id="toc-a-brief-history-of-neural-networks" class="nav-link active" data-scroll-target="#a-brief-history-of-neural-networks">A Brief History of Neural Networks</a>
  <ul>
  <li><a href="#the-artificial-neuron" id="toc-the-artificial-neuron" class="nav-link" data-scroll-target="#the-artificial-neuron">The Artificial Neuron</a></li>
  <li><a href="#mark-1-perceptron" id="toc-mark-1-perceptron" class="nav-link" data-scroll-target="#mark-1-perceptron">Mark 1 Perceptron</a></li>
  <li><a href="#perceptrons" id="toc-perceptrons" class="nav-link" data-scroll-target="#perceptrons">Perceptrons</a></li>
  <li><a href="#parallel-distributed-processing-pdp" id="toc-parallel-distributed-processing-pdp" class="nav-link" data-scroll-target="#parallel-distributed-processing-pdp">Parallel Distributed Processing (PDP)</a></li>
  <li><a href="#s-1990s" id="toc-s-1990s" class="nav-link" data-scroll-target="#s-1990s">1980s-1990s</a></li>
  </ul></li>
  <li><a href="#how-to-learn-deep-learning" id="toc-how-to-learn-deep-learning" class="nav-link" data-scroll-target="#how-to-learn-deep-learning">How to Learn Deep Learning</a>
  <ul>
  <li><a href="#teaching-approach" id="toc-teaching-approach" class="nav-link" data-scroll-target="#teaching-approach">Teaching Approach</a></li>
  <li><a href="#learning-approach" id="toc-learning-approach" class="nav-link" data-scroll-target="#learning-approach">Learning Approach</a></li>
  </ul></li>
  <li><a href="#what-is-machine-learning" id="toc-what-is-machine-learning" class="nav-link" data-scroll-target="#what-is-machine-learning">What is Machine Learning?</a>
  <ul>
  <li><a href="#traditional-programming" id="toc-traditional-programming" class="nav-link" data-scroll-target="#traditional-programming">Traditional Programming</a></li>
  <li><a href="#machine-learning" id="toc-machine-learning" class="nav-link" data-scroll-target="#machine-learning">Machine Learning</a></li>
  <li><a href="#what-is-a-neural-network" id="toc-what-is-a-neural-network" class="nav-link" data-scroll-target="#what-is-a-neural-network">What is a Neural Network?</a></li>
  <li><a href="#deep-learning" id="toc-deep-learning" class="nav-link" data-scroll-target="#deep-learning">Deep learning</a></li>
  <li><a href="#inherent-limitations-of-machine-learning" id="toc-inherent-limitations-of-machine-learning" class="nav-link" data-scroll-target="#inherent-limitations-of-machine-learning">Inherent Limitations of Machine Learning</a></li>
  </ul></li>
  <li><a href="#create-an-image-classifier" id="toc-create-an-image-classifier" class="nav-link" data-scroll-target="#create-an-image-classifier">Create an Image Classifier</a>
  <ul>
  <li><a href="#import-dependencies" id="toc-import-dependencies" class="nav-link" data-scroll-target="#import-dependencies">Import Dependencies</a></li>
  <li><a href="#load-training-data" id="toc-load-training-data" class="nav-link" data-scroll-target="#load-training-data">Load Training Data</a></li>
  <li><a href="#train-a-model" id="toc-train-a-model" class="nav-link" data-scroll-target="#train-a-model">Train a Model</a>
  <ul class="collapse">
  <li><a href="#randomly-initialized-weights" id="toc-randomly-initialized-weights" class="nav-link" data-scroll-target="#randomly-initialized-weights">Randomly Initialized Weights</a></li>
  <li><a href="#pretrained-weights" id="toc-pretrained-weights" class="nav-link" data-scroll-target="#pretrained-weights">Pretrained Weights</a></li>
  </ul></li>
  <li><a href="#use-trained-model" id="toc-use-trained-model" class="nav-link" data-scroll-target="#use-trained-model">Use Trained Model</a></li>
  </ul></li>
  <li><a href="#inspecting-deep-learning-models" id="toc-inspecting-deep-learning-models" class="nav-link" data-scroll-target="#inspecting-deep-learning-models">Inspecting Deep Learning Models</a></li>
  <li><a href="#applying-image-models-to-non-image-tasks" id="toc-applying-image-models-to-non-image-tasks" class="nav-link" data-scroll-target="#applying-image-models-to-non-image-tasks">Applying Image Models to Non-Image Tasks</a></li>
  <li><a href="#other-deep-learning-applications" id="toc-other-deep-learning-applications" class="nav-link" data-scroll-target="#other-deep-learning-applications">Other Deep Learning Applications</a>
  <ul>
  <li><a href="#image-segmentation" id="toc-image-segmentation" class="nav-link" data-scroll-target="#image-segmentation">Image Segmentation</a></li>
  <li><a href="#natural-language-processing-nlp" id="toc-natural-language-processing-nlp" class="nav-link" data-scroll-target="#natural-language-processing-nlp">Natural Language Processing (NLP)</a></li>
  <li><a href="#tabular-data" id="toc-tabular-data" class="nav-link" data-scroll-target="#tabular-data">Tabular Data</a></li>
  <li><a href="#recommendation-systems" id="toc-recommendation-systems" class="nav-link" data-scroll-target="#recommendation-systems">Recommendation Systems</a></li>
  </ul></li>
  <li><a href="#validation-sets-and-test-sets" id="toc-validation-sets-and-test-sets" class="nav-link" data-scroll-target="#validation-sets-and-test-sets">Validation Sets and Test Sets</a></li>
  <li><a href="#jargon" id="toc-jargon" class="nav-link" data-scroll-target="#jargon">Jargon</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Notes on fastai Book Ch. 1</h1>
  <div class="quarto-categories">
    <div class="quarto-category">ai</div>
    <div class="quarto-category">fastai</div>
    <div class="quarto-category">notes</div>
    <div class="quarto-category">pytorch</div>
  </div>
  </div>

<div>
  <div class="description">
    Chapter 1 covers the history of artificial neural networks, approaches for learning ML/DL, and using the fast.ai library for multiple deep learning tasks.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Christian Mills </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 14, 2022</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
This post is part of the following series:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="../../../series/notes/fastai-book-notes.html"><strong>Deep Learning for Coders with fastai &amp; PyTorch</strong></a></li>
</ul>
</div>
</div>
<ul>
<li><a href="#a-brief-history-of-neural-networks">A Brief History of Neural Networks</a></li>
<li><a href="#how-to-learn-deep-learning">How to Learn Deep Learning</a></li>
<li><a href="#what-is-machine-learning?">What is Machine Learning?</a></li>
<li><a href="#create-an-image-classifier">Create an Image Classifier</a></li>
<li><a href="#inspecting-deep-learning-models">Inspecting Deep Learning Models</a></li>
<li><a href="#applying-image-models-to-non-image-tasks">Applying Image Models to Non-Image Tasks</a></li>
<li><a href="#other-deep-learning-applications">Other Deep Learning Applications</a></li>
<li><a href="#jargon">Jargon</a></li>
<li><a href="#references">References</a></li>
</ul>
<section id="a-brief-history-of-neural-networks" class="level2">
<h2 class="anchored" data-anchor-id="a-brief-history-of-neural-networks">A Brief History of Neural Networks</h2>
<section id="the-artificial-neuron" class="level3">
<h3 class="anchored" data-anchor-id="the-artificial-neuron">The Artificial Neuron</h3>
<ul>
<li><p>Developed in 1943 by <a href="https://en.wikipedia.org/wiki/Warren_Sturgis_McCulloch">Warren McCulloch</a>, a neurophysiologist, and <a href="https://en.wikipedia.org/wiki/Walter_Pitts">Walter Pitts</a>, a logician</p></li>
<li><p>A simplified model of a real neuron can be represented using simple addition and thresholding</p></li>
<li><p>Original Paper: <a href="https://www.cs.cmu.edu/~./epxing/Class/10715/reading/McCulloch.and.Pitts.pdf">A Logical Calculus of the Ideas Immanent in Nervous Activity</a></p>
<ul>
<li>Neural events and the relations among them can be treated by means of propositional logic due to the <a href="https://en.wikipedia.org/wiki/All-or-none_law">“all-or-none”</a> character of nervous activity</li>
</ul></li>
</ul>
</section>
<section id="mark-1-perceptron" class="level3">
<h3 class="anchored" data-anchor-id="mark-1-perceptron"><a href="https://en.wikipedia.org/wiki/Perceptron#History">Mark 1 Perceptron</a></h3>
<ul>
<li>The first device based on the principles of artificial neurons</li>
<li>Designed for image recognition
<ul>
<li>Able to recognize simple shapes</li>
</ul></li>
<li>Developed by a psychologist named <a href="https://en.wikipedia.org/wiki/Frank_Rosenblatt">Frank Rosenblatt</a>
<ul>
<li>Gave the artificial neuron the ability to learn</li>
<li>Invented the perceptron algorithm in 1958</li>
<li>Wrote The Design of an Intelligent Automaton</li>
</ul></li>
</ul>
</section>
<section id="perceptrons" class="level3">
<h3 class="anchored" data-anchor-id="perceptrons"><a href="https://en.wikipedia.org/wiki/Perceptrons_(book)">Perceptrons</a></h3>
<ul>
<li>Written by <a href="https://en.wikipedia.org/wiki/Marvin_Minsky">Marvin Minsky</a>, an MIT professor and <a href="https://en.wikipedia.org/wiki/Seymour_Papert">Seymour Papert</a> in 1969</li>
<li>Showed that a single layer of <a href="https://en.wikipedia.org/wiki/Perceptron#History">Mark 1 Perceptron</a> devices was unable to learn some simple but critical math functions like <a href="https://en.wikipedia.org/wiki/XOR_gate">XOR</a></li>
<li>Also showed this limitation could be addressed by using multiple layers
<ul>
<li>This solution was not widely recognized by the global academic community</li>
</ul></li>
</ul>
</section>
<section id="parallel-distributed-processing-pdp" class="level3">
<h3 class="anchored" data-anchor-id="parallel-distributed-processing-pdp">Parallel Distributed Processing (PDP)</h3>
<ul>
<li>Written by <a href="https://en.wikipedia.org/wiki/David_Rumelhart">David Rumelhart</a>, <a href="https://en.wikipedia.org/wiki/James_McClelland_(psychologist)">James McClelland</a>, and the <a href="https://mitpress.mit.edu/contributors/pdp-research-group">PDP Research Group</a>
<ul>
<li>Released in 1986 by MIT Press</li>
</ul></li>
<li>Perhaps the most pivotal work in neural networks in the last 50 years</li>
<li>Posited that traditional computer programs work very differently from brains and that this might be why computer programs were so bad at doing things that brains find easy</li>
<li>Authors claimed the PDP approach was closer to how the brain worked</li>
<li>Laid out an approach that is very similar to today’s neural networks</li>
<li>Defined parallel distributed processing as requiring the following:
<ul>
<li>A set of processing units</li>
<li>A state of activation</li>
<li>An output function for each unit</li>
<li>A pattern of connectivity among units</li>
<li>A propagation rule for propagating patterns of activities through the network of connectivities</li>
<li>An activation rule for combining the inputs impinging on a unit with the current state of the unit to produce an output for the unit</li>
<li>A learning rule whereby patterns of connectivity are modified by experience</li>
<li>An environment within which the system must operate</li>
</ul></li>
<li>Modern neural networks handle each of these requirements</li>
<li><strong>Parallel distributed processing: Explorations in the microstructure of cognition</strong>
<ul>
<li><a href="https://mitpress.mit.edu/books/parallel-distributed-processing-volume-1">Volume 1</a></li>
<li><a href="https://mitpress.mit.edu/books/parallel-distributed-processing-volume-2">Volume 2</a></li>
<li><a href="https://stanford.edu/~jlmcc/papers/PDP/">PDF Scans</a></li>
</ul></li>
</ul>
</section>
<section id="s-1990s" class="level3">
<h3 class="anchored" data-anchor-id="s-1990s">1980s-1990s</h3>
<ul>
<li>Most models were built with a second layer of neurons</li>
<li>Neural networks were used for real, practical projects</li>
<li>A misunderstanding of the theoretical issues held back the field
<ul>
<li>In theory, two-layer models could approximate any mathematical function</li>
<li>In practice, multiple layers are needed to get good, practical performance</li>
</ul></li>
</ul>
</section>
</section>
<section id="how-to-learn-deep-learning" class="level2">
<h2 class="anchored" data-anchor-id="how-to-learn-deep-learning">How to Learn Deep Learning</h2>
<section id="teaching-approach" class="level3">
<h3 class="anchored" data-anchor-id="teaching-approach">Teaching Approach</h3>
<ul>
<li>Teach the whole game
<ul>
<li>Build a foundation of intuition through application then build on it with theory</li>
<li>Show students how individuals pieces of theory are combined in a real-world application</li>
</ul></li>
<li>Teach through examples
<ul>
<li>Provide a context and a purpose for abstract concepts</li>
</ul></li>
<li><a href="https://www.amazon.com/Making-Learning-Whole-Principles-Transform/dp/0470633719">Making Learning Whole by David Perkins</a>
<ul>
<li>Describes how teaching any subject at any level can be made more effective if students are introduced to the “whole game,” rather than isolated pieces of a discipline.</li>
</ul></li>
<li><a href="https://www.maa.org/external_archive/devlin/LockhartsLament.pdf">A Mathematician’s Lament by Paul Lockhart</a>
<ul>
<li>Imagines a nightmare world where music and art are taught the way math is taught</li>
<li>Students spend years doing rote memorization and learning dry, disconnected fundamentals that teachers claim will pay off later</li>
</ul></li>
</ul>
</section>
<section id="learning-approach" class="level3">
<h3 class="anchored" data-anchor-id="learning-approach">Learning Approach</h3>
<ul>
<li>Learn by doing</li>
<li>The hardest part of deep learning is artisanal
<ul>
<li>How do you know if you have enough data?</li>
<li>Is the data in the right format?</li>
<li>Is your model trained properly?</li>
<li>If your model is not trained properly, what should you do about it?</li>
</ul></li>
<li>Start with small projects related to your hobbies and passions, before tackling a big project</li>
<li>Be curious about problems you encounter</li>
<li>Focus on underlying techniques and how to apply them over specific tools or software libraries</li>
<li>Experiment constantly</li>
</ul>
</section>
</section>
<section id="what-is-machine-learning" class="level2">
<h2 class="anchored" data-anchor-id="what-is-machine-learning">What is Machine Learning?</h2>
<ul>
<li>another way to get computers to complete a desired task</li>
</ul>
<section id="traditional-programming" class="level3">
<h3 class="anchored" data-anchor-id="traditional-programming">Traditional Programming</h3>
<ul>
<li>Must explicitly code the exact instructions required to complete a task
<ul>
<li>Difficult when you do not know the exact steps</li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/a-traditional-program.png" class="img-fluid figure-img"></p>
<figcaption>A traditional program</figcaption>
</figure>
</div>
</section>
<section id="machine-learning" class="level3">
<h3 class="anchored" data-anchor-id="machine-learning">Machine Learning</h3>
<ul>
<li><p>Must show the computer examples of the desired task and have it learn how to perform the task through experience</p>
<ul>
<li>Difficult when you do not have sufficient data</li>
</ul></li>
<li><p>Invented by IBM researcher <a href="https://en.wikipedia.org/wiki/Arthur_Samuel">Arthur Samuel</a> in 1949</p>
<ul>
<li>Created a checkers-player program that beat the Connecticut state champion in 1961</li>
<li>Wrote “<a href="https://journals.sagepub.com/doi/abs/10.1177/000271626234000103">Artificial Intelligence: A Frontier of Automation</a>” in 1962
<ul>
<li>Computers are giant morons and need to be told the exact steps required to solve a problem</li>
<li>Show the computer examples of the problem to solve and let if figure out how to solve it itself</li>
<li>Arrange some automatic means of testing the effectiveness of any current weight assignment and provide a mechanism so as to maximize the actual performance</li>
<li>Introduced multiple concepts
<ul>
<li>The idea of “weight assignment”
<ul>
<li>Weights are just variables</li>
<li>A weight assignment is a particular choice of values for those variables</li>
<li>Weight values define how the program will operate</li>
</ul></li>
<li>The fact every weight assignment has some “actual performance”
<ul>
<li>How accurate is the image classifier?</li>
<li>How good is the checkers-player program at playing checkers?</li>
</ul></li>
<li>The requirement there be an “automatic means” of testing that performance
<ul>
<li>Compare performance with the current weight values to the desired result</li>
</ul></li>
<li>The need for a “mechanism” for improving the performance by changing the weight assignments
<ul>
<li>Update the weight values based on the performance with the current values</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/program-using-weight-assignments.png" class="img-fluid figure-img"></p>
<figcaption>A program using weight assignments</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/training-a-machine-learning-model.png" class="img-fluid figure-img"></p>
<figcaption>Training a machine learning model</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/using-a-trained-model.png" class="img-fluid figure-img"></p>
<figcaption>Using a trained model as a program</figcaption>
</figure>
</div>
</section>
<section id="what-is-a-neural-network" class="level3">
<h3 class="anchored" data-anchor-id="what-is-a-neural-network">What is a Neural Network?</h3>
<ul>
<li>A particular kind of machine learning model</li>
<li>Flexible enough to solve a wide variety of problems just by finding the right weight values</li>
<li><a href="https://en.wikipedia.org/wiki/Universal_approximation_theorem">Universal Approximation Theorem</a>: shows that a neural network can, in theory, solve any problem to any level of accuracy</li>
<li><a href="https://en.wikipedia.org/wiki/Stochastic_gradient_descent">Stochastic Gradient Descent</a>: a general way to automatically update the weights of a neural network to make it improve at any given task</li>
</ul>
</section>
<section id="deep-learning" class="level3">
<h3 class="anchored" data-anchor-id="deep-learning">Deep learning</h3>
<ul>
<li>A computer science technique to extract and transform data by using multiple layers of neural networks</li>
<li>Output from the previous layer serves as input for the next</li>
<li>Each layer progressively refines their input</li>
<li>A neural network learns to perform a specified task through training its layers using algorithms that minimize their errors and improve their accuracy</li>
</ul>
</section>
<section id="inherent-limitations-of-machine-learning" class="level3">
<h3 class="anchored" data-anchor-id="inherent-limitations-of-machine-learning">Inherent Limitations of Machine Learning</h3>
<ul>
<li>A model cannot be created without data</li>
<li>A model can learn to operate on only the patterns seen in the input data used to train it</li>
<li>This learning approach only creates predictions, not recommended actions
<ul>
<li>can result in a significant gap between organizational goals and model capabilities</li>
</ul></li>
<li>Need labels for each example input in the training data</li>
<li>The way a model interacts with its environment can create feedback loops that amplify existing biases
<ol type="1">
<li>A predictive policing algorithm that is trained on data from past arrests will learn to predict arrests rather than to predict crime</li>
<li>Law enforcement officers using the model might decide to focus policing activity in areas where previous arrests were made, resulting in more arrests in those areas</li>
<li>The data from these new arrests are then fed into the model, increasing its bias towards those areas</li>
</ol></li>
</ul>
</section>
</section>
<section id="create-an-image-classifier" class="level2">
<h2 class="anchored" data-anchor-id="create-an-image-classifier">Create an Image Classifier</h2>
<section id="import-dependencies" class="level3">
<h3 class="anchored" data-anchor-id="import-dependencies">Import Dependencies</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import fastai computer vision library</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Includes functions and classes to create a wide variety of computer vision models</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.vision.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="load-training-data" class="level3">
<h3 class="anchored" data-anchor-id="load-training-data">Load Training Data</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download and extract the training dataset </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># base directory: '~/.fastai'</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># returns a Path object: https://docs.python.org/3/library/pathlib.html</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.PETS)<span class="op">/</span><span class="st">'images'</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(path))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>&lt;class 'pathlib.PosixPath'&gt;
/home/innom-dt/.fastai/data/oxford-iiit-pet/images</code></pre>
<p><strong>Oxford-IIT Pet Dataset:</strong> contains 7,390 images of cats and dogs from 37 breeds</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>URLs.PETS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>'https://s3.amazonaws.com/fast-ai-imageclas/oxford-iiit-pet.tgz'</code></pre>
<hr>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls <span class="op">~/</span>.fastai<span class="op">/</span>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>annotations  coco_sample  oxford-iiit-pet</code></pre>
<hr>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls <span class="op">~/</span>.fastai<span class="op">/</span>data<span class="op">/</span>oxford<span class="op">-</span>iiit<span class="op">-</span>pet<span class="op">/</span>images<span class="op">|</span> head <span class="op">-</span><span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>Abyssinian_100.jpg
Abyssinian_100.mat
Abyssinian_101.jpg
Abyssinian_101.mat
Abyssinian_102.jpg
ls: write error: Broken pipe</code></pre>
<hr>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns true if the first letter in the string is upper case</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_cat(x): <span class="cf">return</span> x[<span class="dv">0</span>].isupper()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">str</span>.isupper</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>&lt;method 'isupper' of 'str' objects&gt;</code></pre>
<hr>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>is_cat(<span class="st">"word"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>False</code></pre>
<hr>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>is_cat(<span class="st">"Word"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>True</code></pre>
<hr>
<div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>is_cat(<span class="st">"woRd"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>False</code></pre>
<hr>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cat breeds are upper case</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls <span class="op">~/</span>.fastai<span class="op">/</span>data<span class="op">/</span>oxford<span class="op">-</span>iiit<span class="op">-</span>pet<span class="op">/</span>images<span class="op">/</span>[[:upper:]]<span class="op">*</span> <span class="op">|</span> head <span class="op">-</span><span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>/home/innom-dt/.fastai/data/oxford-iiit-pet/images/Abyssinian_100.jpg
/home/innom-dt/.fastai/data/oxford-iiit-pet/images/Abyssinian_100.mat
/home/innom-dt/.fastai/data/oxford-iiit-pet/images/Abyssinian_101.jpg
/home/innom-dt/.fastai/data/oxford-iiit-pet/images/Abyssinian_101.mat
/home/innom-dt/.fastai/data/oxford-iiit-pet/images/Abyssinian_102.jpg
ls: write error: Broken pipe</code></pre>
<hr>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dog breeds are lower case</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls <span class="op">~/</span>.fastai<span class="op">/</span>data<span class="op">/</span>oxford<span class="op">-</span>iiit<span class="op">-</span>pet<span class="op">/</span>images<span class="op">/</span>[[:lower:]]<span class="op">*</span> <span class="op">|</span> head <span class="op">-</span><span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>/home/innom-dt/.fastai/data/oxford-iiit-pet/images/american_bulldog_100.jpg
/home/innom-dt/.fastai/data/oxford-iiit-pet/images/american_bulldog_101.jpg
/home/innom-dt/.fastai/data/oxford-iiit-pet/images/american_bulldog_102.jpg
/home/innom-dt/.fastai/data/oxford-iiit-pet/images/american_bulldog_103.jpg
/home/innom-dt/.fastai/data/oxford-iiit-pet/images/american_bulldog_104.jpg
ls: write error: Broken pipe</code></pre>
<hr>
<div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataloader to feed image files from dataset to the model</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Reserves 20% of the available images for the validation set</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sets the random seed to get consistent results in each training session</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Uses the is_cat() function to identify image classes</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - Upper case will be the first class</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Resizes and crops images to 224x224</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Uses 8 cpu workers to load images during training</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> ImageDataLoaders.from_name_func(</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    path, get_image_files(path), valid_pct<span class="op">=</span><span class="fl">0.2</span>, seed<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    label_func<span class="op">=</span>is_cat, item_tfms<span class="op">=</span>Resize(<span class="dv">224</span>), num_workers<span class="op">=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(get_image_files(path)))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>img_files <span class="op">=</span> get_image_files(path)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(img_files[i])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>7390
/home/innom-dt/.fastai/data/oxford-iiit-pet/images/Birman_121.jpg
/home/innom-dt/.fastai/data/oxford-iiit-pet/images/shiba_inu_131.jpg
/home/innom-dt/.fastai/data/oxford-iiit-pet/images/Bombay_176.jpg
/home/innom-dt/.fastai/data/oxford-iiit-pet/images/Bengal_199.jpg
/home/innom-dt/.fastai/data/oxford-iiit-pet/images/beagle_41.jpg</code></pre>
<hr>
<div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>dls.after_item</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>Pipeline: Resize -- {'size': (224, 224), 'method': 'crop', 'pad_mode': 'reflection', 'resamples': (2, 0), 'p': 1.0} -&gt; ToTensor</code></pre>
<hr>
<div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dls.after_batch</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>Pipeline: IntToFloatTensor -- {'div': 255.0, 'div_mask': 1}</code></pre>
</section>
<section id="train-a-model" class="level3">
<h3 class="anchored" data-anchor-id="train-a-model">Train a Model</h3>
<section id="randomly-initialized-weights" class="level4">
<h4 class="anchored" data-anchor-id="randomly-initialized-weights">Randomly Initialized Weights</h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> cnn_learner(dls, resnet34, metrics<span class="op">=</span>accuracy, pretrained<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="overflow-x:auto;">
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
epoch
</th>
<th>
train_loss
</th>
<th>
valid_loss
</th>
<th>
accuracy
</th>
<th>
time
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
1.004878
</td>
<td>
0.697246
</td>
<td>
0.662382
</td>
<td>
00:11
</td>
</tr>
</tbody>
</table>
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
epoch
</th>
<th>
train_loss
</th>
<th>
valid_loss
</th>
<th>
accuracy
</th>
<th>
time
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
0.745436
</td>
<td>
0.612512
</td>
<td>
0.688769
</td>
<td>
00:14
</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="pretrained-weights" class="level4">
<h4 class="anchored" data-anchor-id="pretrained-weights">Pretrained Weights</h4>
<div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># removes the last layer of the of the pretrained resnet34 and</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># replaces it with a new output layer for the target dataset</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> cnn_learner(dls, resnet34, metrics<span class="op">=</span>accuracy, pretrained<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="overflow-x:auto;">
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
epoch
</th>
<th>
train_loss
</th>
<th>
valid_loss
</th>
<th>
accuracy
</th>
<th>
time
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
0.162668
</td>
<td>
0.023766
</td>
<td>
0.989851
</td>
<td>
00:11
</td>
</tr>
</tbody>
</table>
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
epoch
</th>
<th>
train_loss
</th>
<th>
valid_loss
</th>
<th>
accuracy
</th>
<th>
time
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
0.061914
</td>
<td>
0.014920
</td>
<td>
0.993234
</td>
<td>
00:14
</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a convolutional neural network-style learner from the dataloader and model architecture</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>cnn_learner</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>&lt;function fastai.vision.learner.cnn_learner(dls, arch, normalize=True, n_out=None, pretrained=True, config=None, loss_func=None, opt_func=&lt;function Adam at 0x7f0e87aa2040&gt;, lr=0.001, splitter=None, cbs=None, metrics=None, path=None, model_dir='models', wd=None, wd_bn_bias=False, train_bn=True, moms=(0.95, 0.85, 0.95), cut=None, n_in=3, init=&lt;function kaiming_normal_ at 0x7f0ed3b4f820&gt;, custom_head=None, concat_pool=True, lin_ftrs=None, ps=0.5, first_bn=True, bn_final=False, lin_first=False, y_range=None)&gt;</code></pre>
<hr>
<div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ResNet-34 model from [Deep Residual Learning for Image Recognition](https://arxiv.org/pdf/1512.03385.pdf)</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the pretrained version has already been trained to recognize</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># a thousand different categories on 1.3 million images</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>resnet34</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>&lt;function torchvision.models.resnet.resnet34(pretrained: bool = False, progress: bool = True, **kwargs: Any) -&gt; torchvision.models.resnet.ResNet&gt;</code></pre>
<hr>
<div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># based on https://github.com/sksq96/pytorch-summary/blob/master/torchsummary/torchsummary.py</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_total_params(model, input_size, batch_size<span class="op">=-</span><span class="dv">1</span>, device<span class="op">=</span><span class="st">'cuda'</span>, dtypes<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> register_hook(module):</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> hook(module, <span class="bu">input</span>, output):</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>            class_name <span class="op">=</span> <span class="bu">str</span>(module.__class__).split(<span class="st">"."</span>)[<span class="op">-</span><span class="dv">1</span>].split(<span class="st">"'"</span>)[<span class="dv">0</span>]</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>            module_idx <span class="op">=</span> <span class="bu">len</span>(summary)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>            m_key <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>class_name<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>module_idx <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">"</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>            summary[m_key] <span class="op">=</span> OrderedDict()</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>            params <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">hasattr</span>(module, <span class="st">"weight"</span>) <span class="kw">and</span> <span class="bu">hasattr</span>(module.weight, <span class="st">"size"</span>):</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>                params <span class="op">+=</span> torch.prod(torch.LongTensor(<span class="bu">list</span>(module.weight.size())))</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">hasattr</span>(module, <span class="st">"bias"</span>) <span class="kw">and</span> <span class="bu">hasattr</span>(module.bias, <span class="st">"size"</span>):</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>                params <span class="op">+=</span> torch.prod(torch.LongTensor(<span class="bu">list</span>(module.bias.size())))</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>            summary[m_key][<span class="st">"nb_params"</span>] <span class="op">=</span> params</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>            <span class="kw">not</span> <span class="bu">isinstance</span>(module, nn.Sequential)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">and</span> <span class="kw">not</span> <span class="bu">isinstance</span>(module, nn.ModuleList)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>            <span class="kw">and</span> <span class="kw">not</span> (module <span class="op">==</span> model)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>        ):</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>            hooks.append(module.register_forward_hook(hook))</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> device <span class="op">==</span> <span class="st">"cuda"</span> <span class="kw">and</span> torch.cuda.is_available():</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>        dtype <span class="op">=</span> torch.cuda.FloatTensor</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>        dtype <span class="op">=</span> torch.FloatTensor</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># multiple inputs to the network</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(input_size, <span class="bu">tuple</span>):</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>        input_size <span class="op">=</span> [input_size]</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># batch_size of 2 for batchnorm</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> [torch.rand(<span class="dv">2</span>, <span class="op">*</span>in_size).<span class="bu">type</span>(dtype) <span class="cf">for</span> in_size <span class="kw">in</span> input_size]</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create properties</span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>    summary <span class="op">=</span> OrderedDict()</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>    hooks <span class="op">=</span> []</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># register hook</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">apply</span>(register_hook)</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># make a forward pass</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>    model(<span class="op">*</span>x)</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove these hooks</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> h <span class="kw">in</span> hooks:</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>        h.remove()</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>    total_params <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> layer <span class="kw">in</span> summary:</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>        total_params <span class="op">+=</span> summary[layer][<span class="st">"nb_params"</span>]</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total_params</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>input_shape <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">224</span>, <span class="dv">224</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"ResNet18 Total params: </span><span class="sc">{</span>get_total_params(resnet18().cuda(), input_shape)<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"ResNet34 Total params: </span><span class="sc">{</span>get_total_params(resnet34().cuda(), input_shape)<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"ResNet50 Total params: </span><span class="sc">{</span>get_total_params(resnet50().cuda(), input_shape)<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"ResNet101 Total params: </span><span class="sc">{</span>get_total_params(resnet101().cuda(), input_shape)<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"ResNet152 Total params: </span><span class="sc">{</span>get_total_params(resnet152().cuda(), input_shape)<span class="sc">:,}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>ResNet18 Total params: 11,689,512
ResNet34 Total params: 21,797,672
ResNet50 Total params: 25,557,032
ResNet101 Total params: 44,549,160
ResNet152 Total params: 60,192,808</code></pre>
<hr>
<div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 - accuracy</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>error_rate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>&lt;function fastai.metrics.error_rate(inp, targ, axis=-1)&gt;</code></pre>
<hr>
<div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 - error_rate</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>&lt;function fastai.metrics.accuracy(inp, targ, axis=-1)&gt;</code></pre>
</section>
</section>
<section id="use-trained-model" class="level3">
<h3 class="anchored" data-anchor-id="use-trained-model">Use Trained Model</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Upload file(s) from browser to Python kernel as bytes</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>uploader <span class="op">=</span> widgets.FileUpload()</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>uploader</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>FileUpload(value={}, description='Upload')</code></pre>
<hr>
<div class="sourceCode" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Open an `Image` from path `fn`</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Accepts pathlib.Path, str, torch.Tensor, numpy.ndarray and bytes objects</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> PILImage.create(uploader.data[<span class="dv">0</span>])</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Type: </span><span class="sc">{</span><span class="bu">type</span>(img)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>img</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>Type: &lt;class 'fastai.vision.core.PILImage'&gt;</code></pre>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/output_32_1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction on `item`, fully decoded, loss function decoded and probabilities</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>is_cat,_,probs <span class="op">=</span> learn.predict(img)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Is this a cat?: </span><span class="sc">{</span>is_cat<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Probability it's a cat: </span><span class="sc">{</span>probs[<span class="dv">1</span>]<span class="sc">.</span>item()<span class="sc">:.6f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>Is this a cat?: False.
Probability it's a cat: 0.000024</code></pre>
<hr>
<div class="sourceCode" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>uploader <span class="op">=</span> widgets.FileUpload()</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>uploader</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>FileUpload(value={}, description='Upload')</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> PILImage.create(uploader.data[<span class="dv">0</span>])</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>img</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/output_36_0.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="sourceCode" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>is_cat,_,probs <span class="op">=</span> learn.predict(img)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Is this a cat?: </span><span class="sc">{</span>is_cat<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Probability it's a cat: </span><span class="sc">{</span>probs[<span class="dv">1</span>]<span class="sc">.</span>item()<span class="sc">:.6f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>Is this a cat?: True.
Probability it's a cat: 1.000000</code></pre>
</section>
</section>
<section id="inspecting-deep-learning-models" class="level2">
<h2 class="anchored" data-anchor-id="inspecting-deep-learning-models">Inspecting Deep Learning Models</h2>
<ul>
<li>It is possible to inspect deep learning models and get rich insights from them
<ul>
<li>can still be challenging to fully understand</li>
</ul></li>
<li><a href="https://arxiv.org/abs/1311.2901">Visualizing and Understanding Convolutional Networks</a>
<ul>
<li>published by PhD student Matt Zeiler and his supervisor Rob Fergus in 2013</li>
<li>showed how to visualize the neural network weights learned in each layer of a model</li>
<li>discovered the early layers in a convolutional neural network recognize edges and simple patterns which are combined in later layers to detect more complex shapes
<ul>
<li>very similar to the basic visual machinery in the human eye</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="applying-image-models-to-non-image-tasks" class="level2">
<h2 class="anchored" data-anchor-id="applying-image-models-to-non-image-tasks">Applying Image Models to Non-Image Tasks</h2>
<ul>
<li>A lot of data can be represented as images</li>
<li>Sound can be converted to a spectrogram
<ul>
<li><strong>spectrogram</strong>: a chart that shows the amount of each frequency at each time in an audio file</li>
</ul></li>
<li>Time series can be converted to an image by plotting the time series on a graph
<ul>
<li>Various transformations available for time series data
<ul>
<li><a href="http://fast.ai">fast.ai</a> student Ignacio Oguiza created images from time series data using <a href="https://pyts.readthedocs.io/en/0.10.0/auto_examples/image/plot_gaf.html">Gramian Angular Difference Field</a> (GADF)
<ul>
<li>an image obtained from a time series, representing some temporal correlation between each time point</li>
</ul></li>
<li><a href="http://fast.ai">fast.ai</a> student Gleb Esman converted mouse movements and clicks to images for fraud detection</li>
<li><a href="https://ieeexplore.ieee.org/abstract/document/8328749">Malware Classification with Deep Convolutional Neural Networks</a>
<ul>
<li>the malware binary file is divided into 8-bit sequences which are then converted to equivalent decimal values</li>
<li>the decimal values are used to generate a grayscale image the represents the malware sample</li>
</ul></li>
</ul></li>
</ul></li>
<li>It is often a good idea to represent your data in a way that makes it as easy as possible to pull out the most important components
<ul>
<li>In a time series, things like seasonality and anomalies are most likely to be of interest</li>
</ul></li>
<li>Rule of thumb: if the human eye can recognize categories from images, then a deep learning model should be able to as well</li>
</ul>
</section>
<section id="other-deep-learning-applications" class="level2">
<h2 class="anchored" data-anchor-id="other-deep-learning-applications">Other Deep Learning Applications</h2>
<section id="image-segmentation" class="level3">
<h3 class="anchored" data-anchor-id="image-segmentation">Image Segmentation</h3>
<ul>
<li>training a model to recognize the content of every single pixel in an image</li>
</ul>
<hr>
<div class="sourceCode" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.CAMVID_TINY)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>/home/innom-dt/.fastai/data/camvid_tiny</code></pre>
<hr>
<div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls $path</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>codes.txt  images  labels</code></pre>
<hr>
<div class="sourceCode" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic wrapper around several `DataLoader`s with factory methods for segmentation problems</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> SegmentationDataLoaders.from_label_func(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    path, bs<span class="op">=</span><span class="dv">8</span>, fnames <span class="op">=</span> get_image_files(path<span class="op">/</span><span class="st">"images"</span>),</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    label_func <span class="op">=</span> <span class="kw">lambda</span> o: path<span class="op">/</span><span class="st">'labels'</span><span class="op">/</span><span class="ss">f'</span><span class="sc">{</span>o<span class="sc">.</span>stem<span class="sc">}</span><span class="ss">_P</span><span class="sc">{</span>o<span class="sc">.</span>suffix<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    codes <span class="op">=</span> np.loadtxt(path<span class="op">/</span><span class="st">'codes.txt'</span>, dtype<span class="op">=</span><span class="bu">str</span>), seed<span class="op">=</span><span class="dv">42</span>, num_workers<span class="op">=</span><span class="dv">8</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>img_files <span class="op">=</span> get_image_files(path<span class="op">/</span><span class="st">"images"</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(img_files))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(img_files[i])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>100
/home/innom-dt/.fastai/data/camvid_tiny/images/0016E5_08155.png
/home/innom-dt/.fastai/data/camvid_tiny/images/Seq05VD_f03210.png
/home/innom-dt/.fastai/data/camvid_tiny/images/Seq05VD_f03060.png
/home/innom-dt/.fastai/data/camvid_tiny/images/Seq05VD_f03660.png
/home/innom-dt/.fastai/data/camvid_tiny/images/0016E5_05310.png</code></pre>
<hr>
<div class="sourceCode" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>path<span class="op">/</span><span class="st">'labels'</span><span class="op">/</span><span class="ss">f'</span><span class="sc">{</span>img_files[<span class="dv">0</span>]<span class="sc">.</span>stem<span class="sc">}</span><span class="ss">_P</span><span class="sc">{</span>img_files[<span class="dv">0</span>]<span class="sc">.</span>suffix<span class="sc">}</span><span class="ss">'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>Path('/home/innom-dt/.fastai/data/camvid_tiny/labels/0016E5_08155_P.png')</code></pre>
<hr>
<div class="sourceCode" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a unet learner</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> unet_learner(dls, resnet34, pretrained<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="overflow-x:auto;">
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
epoch
</th>
<th>
train_loss
</th>
<th>
valid_loss
</th>
<th>
time
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
2.914330
</td>
<td>
2.284680
</td>
<td>
00:01
</td>
</tr>
</tbody>
</table>
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
epoch
</th>
<th>
train_loss
</th>
<th>
valid_loss
</th>
<th>
time
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
1.906939
</td>
<td>
1.415985
</td>
<td>
00:01
</td>
</tr>
<tr>
<td>
1
</td>
<td>
1.628720
</td>
<td>
1.185889
</td>
<td>
00:01
</td>
</tr>
<tr>
<td>
2
</td>
<td>
1.454888
</td>
<td>
1.024575
</td>
<td>
00:01
</td>
</tr>
<tr>
<td>
3
</td>
<td>
1.290813
</td>
<td>
0.921251
</td>
<td>
00:01
</td>
</tr>
<tr>
<td>
4
</td>
<td>
1.152427
</td>
<td>
0.809383
</td>
<td>
00:01
</td>
</tr>
<tr>
<td>
5
</td>
<td>
1.034114
</td>
<td>
0.793250
</td>
<td>
00:01
</td>
</tr>
<tr>
<td>
6
</td>
<td>
0.941492
</td>
<td>
0.782535
</td>
<td>
00:01
</td>
</tr>
<tr>
<td>
7
</td>
<td>
0.869773
</td>
<td>
0.778228
</td>
<td>
00:01
</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceCode" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>learn.show_results(max_n<span class="op">=</span><span class="dv">6</span>, figsize<span class="op">=</span>(<span class="dv">18</span>,<span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/output_47_2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="natural-language-processing-nlp" class="level3">
<h3 class="anchored" data-anchor-id="natural-language-processing-nlp">Natural Language Processing (NLP)</h3>
<ul>
<li>generate text</li>
<li>translate from one language to another</li>
<li>analyze comments</li>
<li>label words in sentences</li>
</ul>
<hr>
<div class="sourceCode" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.text.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<p>IMDB Large Moview Review Dataset</p>
<ul>
<li>from <a href="https://ai.stanford.edu/~ang/papers/acl11-WordVectorsSentimentAnalysis.pdf">Learning Word Vectors for Sentiment Analysis</a></li>
</ul>
<hr>
<div class="sourceCode" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.IMDB)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>path</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>Path('/home/innom-dt/.fastai/data/imdb')</code></pre>
<hr>
<div class="sourceCode" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls $path</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>imdb.vocab  README  test  tmp_clas  tmp_lm  train  unsup</code></pre>
<hr>
<div class="sourceCode" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic wrapper around several `DataLoader`s with factory methods for NLP problems</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> TextDataLoaders.from_folder(path, valid<span class="op">=</span><span class="st">'test'</span>, bs<span class="op">=</span><span class="dv">64</span>, seed<span class="op">=</span><span class="dv">42</span>, num_workers<span class="op">=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<div class="sourceCode" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(dls.items)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>25000</code></pre>
<hr>
<div class="sourceCode" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>dls.after_iter</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>&lt;bound method after_iter of &lt;fastai.text.data.SortedDL object at 0x7f0f493cb9d0&gt;&gt;</code></pre>
<hr>
<div class="sourceCode" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A `DataLoader` that goes throught the item in the order given by `sort_func`</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>SortedDL</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<div class="sourceCode" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls $path<span class="op">/</span>train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>labeledBow.feat  neg  pos  unsupBow.feat</code></pre>
<hr>
<div class="sourceCode" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls $path<span class="op">/</span>train<span class="op">/</span>pos <span class="op">|</span> wc <span class="op">-</span>l</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>12500</code></pre>
<hr>
<div class="sourceCode" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls $path<span class="op">/</span>train<span class="op">/</span>pos <span class="op">|</span> head <span class="op">-</span><span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>0_9.txt
10000_8.txt
10001_10.txt
10002_7.txt
10003_8.txt
ls: write error: Broken pipe</code></pre>
<hr>
<div class="sourceCode" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cat $path<span class="op">/</span>train<span class="op">/</span>pos<span class="op">/</span><span class="fl">0_9.</span><span class="er">txt</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>Bromwell High is a cartoon comedy. It ran at the same time as some other programs about school life, such as "Teachers". My 35 years in the teaching profession lead me to believe that Bromwell High's satire is much closer to reality than is "Teachers". The scramble to survive financially, the insightful students who can see right through their pathetic teachers' pomp, the pettiness of the whole situation, all remind me of the schools I knew and their students. When I saw the episode in which a student repeatedly tried to burn down the school, I immediately recalled ......... at .......... High. A classic line: INSPECTOR: I'm here to sack one of your teachers. STUDENT: Welcome to Bromwell High. I expect that many adults of my age think that Bromwell High is far fetched. What a pity that it isn't!</code></pre>
<hr>
<div class="sourceCode" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls $path<span class="op">/</span>train<span class="op">/</span>neg <span class="op">|</span> wc <span class="op">-</span>l</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>12500</code></pre>
<hr>
<div class="sourceCode" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls $path<span class="op">/</span>train<span class="op">/</span>neg <span class="op">|</span> head <span class="op">-</span><span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>0_3.txt
10000_4.txt
10001_4.txt
10002_1.txt
10003_1.txt
ls: write error: Broken pipe</code></pre>
<hr>
<div class="sourceCode" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cat $path<span class="op">/</span>train<span class="op">/</span>neg<span class="op">/</span><span class="fl">0_3.</span><span class="er">txt</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>Story of a man who has unnatural feelings for a pig. Starts out with a opening scene that is a terrific example of absurd comedy. A formal orchestra audience is turned into an insane, violent mob by the crazy chantings of it's singers. Unfortunately it stays absurd the WHOLE time with no general narrative eventually making it just too off putting. Even those from the era should be turned off. The cryptic dialogue would make Shakespeare seem easy to a third grader. On a technical level it's better than you might think with some good cinematography by future great Vilmos Zsigmond. Future stars Sally Kirkland and Frederic Forrest can be seen briefly.</code></pre>
<hr>
<div class="sourceCode" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a `Learner` with a text classifier</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> text_classifier_learner(dls, AWD_LSTM, drop_mult<span class="op">=</span><span class="fl">0.5</span>, metrics<span class="op">=</span>accuracy)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">4</span>, <span class="fl">1e-2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="overflow-x:auto;">
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
epoch
</th>
<th>
train_loss
</th>
<th>
valid_loss
</th>
<th>
accuracy
</th>
<th>
time
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
0.460765
</td>
<td>
0.407599
</td>
<td>
0.815200
</td>
<td>
01:25
</td>
</tr>
</tbody>
</table>
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
epoch
</th>
<th>
train_loss
</th>
<th>
valid_loss
</th>
<th>
accuracy
</th>
<th>
time
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
0.316035
</td>
<td>
0.262926
</td>
<td>
0.895640
</td>
<td>
02:46
</td>
</tr>
<tr>
<td>
1
</td>
<td>
0.250969
</td>
<td>
0.223144
</td>
<td>
0.908440
</td>
<td>
02:48
</td>
</tr>
<tr>
<td>
2
</td>
<td>
0.186867
</td>
<td>
0.187719
</td>
<td>
0.926720
</td>
<td>
02:48
</td>
</tr>
<tr>
<td>
3
</td>
<td>
0.146174
</td>
<td>
0.190528
</td>
<td>
0.927880
</td>
<td>
02:50
</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceCode" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>learn.predict(<span class="st">"I really liked that movie!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>('pos', TensorText(1), TensorText([5.5877e-04, 9.9944e-01]))</code></pre>
<hr>
<div class="sourceCode" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>learn.predict(<span class="st">"I really hated that movie!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>('neg', TensorText(0), TensorText([0.9534, 0.0466]))</code></pre>
</section>
<section id="tabular-data" class="level3">
<h3 class="anchored" data-anchor-id="tabular-data">Tabular Data</h3>
<ul>
<li>data that in in the form of a table
<ul>
<li>spreedsheets</li>
<li>databases</li>
<li>Comma-separated Values (CSV) files</li>
</ul></li>
<li>model tries to predict the value of one column based on information in other columns</li>
</ul>
<hr>
<div class="sourceCode" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.tabular.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Adult Dataset * from the paper <a href="https://www.aaai.org/Papers/KDD/1996/KDD96-033.pdf">Scaling Up the Accuracy of Naive-Bayes Classifiers: a Decision-Tree Hybrid</a> * contains some demographic data about individuals</p>
<hr>
<div class="sourceCode" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.ADULT_SAMPLE)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>/home/innom-dt/.fastai/data/adult_sample</code></pre>
<hr>
<div class="sourceCode" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls $path</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>adult.csv  export.pkl  models</code></pre>
<hr>
<div class="sourceCode" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cat $path<span class="op">/</span>adult.csv <span class="op">|</span> head <span class="op">-</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>age,workclass,fnlwgt,education,education-num,marital-status,occupation,relationship,race,sex,capital-gain,capital-loss,hours-per-week,native-country,salary
cat: write error: Broken pipe</code></pre>
<hr>
<div class="sourceCode" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>pd.read_csv(<span class="ss">f"</span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">/adult.csv"</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="overflow-x:auto;">
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
</th>
<th>
age
</th>
<th>
workclass
</th>
<th>
fnlwgt
</th>
<th>
education
</th>
<th>
education-num
</th>
<th>
marital-status
</th>
<th>
occupation
</th>
<th>
relationship
</th>
<th>
race
</th>
<th>
sex
</th>
<th>
capital-gain
</th>
<th>
capital-loss
</th>
<th>
hours-per-week
</th>
<th>
native-country
</th>
<th>
salary
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
49
</td>
<td>
Private
</td>
<td>
101320
</td>
<td>
Assoc-acdm
</td>
<td>
12.0
</td>
<td>
Married-civ-spouse
</td>
<td>
NaN
</td>
<td>
Wife
</td>
<td>
White
</td>
<td>
Female
</td>
<td>
0
</td>
<td>
1902
</td>
<td>
40
</td>
<td>
United-States
</td>
<td>
&gt;=50k
</td>
</tr>
<tr>
<th>
1
</th>
<td>
44
</td>
<td>
Private
</td>
<td>
236746
</td>
<td>
Masters
</td>
<td>
14.0
</td>
<td>
Divorced
</td>
<td>
Exec-managerial
</td>
<td>
Not-in-family
</td>
<td>
White
</td>
<td>
Male
</td>
<td>
10520
</td>
<td>
0
</td>
<td>
45
</td>
<td>
United-States
</td>
<td>
&gt;=50k
</td>
</tr>
<tr>
<th>
2
</th>
<td>
38
</td>
<td>
Private
</td>
<td>
96185
</td>
<td>
HS-grad
</td>
<td>
NaN
</td>
<td>
Divorced
</td>
<td>
NaN
</td>
<td>
Unmarried
</td>
<td>
Black
</td>
<td>
Female
</td>
<td>
0
</td>
<td>
0
</td>
<td>
32
</td>
<td>
United-States
</td>
<td>
&lt;50k
</td>
</tr>
<tr>
<th>
3
</th>
<td>
38
</td>
<td>
Self-emp-inc
</td>
<td>
112847
</td>
<td>
Prof-school
</td>
<td>
15.0
</td>
<td>
Married-civ-spouse
</td>
<td>
Prof-specialty
</td>
<td>
Husband
</td>
<td>
Asian-Pac-Islander
</td>
<td>
Male
</td>
<td>
0
</td>
<td>
0
</td>
<td>
40
</td>
<td>
United-States
</td>
<td>
&gt;=50k
</td>
</tr>
<tr>
<th>
4
</th>
<td>
42
</td>
<td>
Self-emp-not-inc
</td>
<td>
82297
</td>
<td>
7th-8th
</td>
<td>
NaN
</td>
<td>
Married-civ-spouse
</td>
<td>
Other-service
</td>
<td>
Wife
</td>
<td>
Black
</td>
<td>
Female
</td>
<td>
0
</td>
<td>
0
</td>
<td>
50
</td>
<td>
United-States
</td>
<td>
&lt;50k
</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceCode" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> TabularDataLoaders.from_csv(path<span class="op">/</span><span class="st">'adult.csv'</span>, path<span class="op">=</span>path, y_names<span class="op">=</span><span class="st">"salary"</span>,</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    cat_names <span class="op">=</span> [<span class="st">'workclass'</span>, <span class="st">'education'</span>, <span class="st">'marital-status'</span>, <span class="st">'occupation'</span>,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'relationship'</span>, <span class="st">'race'</span>],</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    cont_names <span class="op">=</span> [<span class="st">'age'</span>, <span class="st">'fnlwgt'</span>, <span class="st">'education-num'</span>],</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    procs <span class="op">=</span> [</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Transform the categorical variables to something similar to `pd.Categorical`        </span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>        Categorify, </span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Fill the missing values in continuous columns.</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>        FillMissing,</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Normalize/denorm batch</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>        Normalize</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    ], bs<span class="op">=</span><span class="dv">64</span>, seed<span class="op">=</span><span class="dv">42</span>, num_workers<span class="op">=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> tabular_learner(dls, metrics<span class="op">=</span>accuracy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>learn.fit_one_cycle(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="overflow-x:auto;">
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
epoch
</th>
<th>
train_loss
</th>
<th>
valid_loss
</th>
<th>
accuracy
</th>
<th>
time
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
0.383882
</td>
<td>
0.353906
</td>
<td>
0.839834
</td>
<td>
00:02
</td>
</tr>
<tr>
<td>
1
</td>
<td>
0.369853
</td>
<td>
0.343141
</td>
<td>
0.844134
</td>
<td>
00:02
</td>
</tr>
<tr>
<td>
2
</td>
<td>
0.353572
</td>
<td>
0.340899
</td>
<td>
0.844441
</td>
<td>
00:02
</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="recommendation-systems" class="level3">
<h3 class="anchored" data-anchor-id="recommendation-systems">Recommendation Systems</h3>
<ul>
<li>model tries to predict the rating a user would give for something</li>
</ul>
<hr>
<div class="sourceCode" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.collab <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.ML_SAMPLE)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text"><code>/home/innom-dt/.fastai/data/movie_lens_sample</code></pre>
<hr>
<div class="sourceCode" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> CollabDataLoaders.from_csv(path<span class="op">/</span><span class="st">'ratings.csv'</span>, bs<span class="op">=</span><span class="dv">64</span>, seed<span class="op">=</span><span class="dv">42</span>, num_workers<span class="op">=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> collab_learner(dls, y_range<span class="op">=</span>(<span class="fl">0.5</span>,<span class="fl">5.5</span>))</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="overflow-x:auto;">
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
epoch
</th>
<th>
train_loss
</th>
<th>
valid_loss
</th>
<th>
time
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
1.503958
</td>
<td>
1.418632
</td>
<td>
00:00
</td>
</tr>
</tbody>
</table>
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
epoch
</th>
<th>
train_loss
</th>
<th>
valid_loss
</th>
<th>
time
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
1.376203
</td>
<td>
1.359422
</td>
<td>
00:00
</td>
</tr>
<tr>
<td>
1
</td>
<td>
1.252138
</td>
<td>
1.180762
</td>
<td>
00:00
</td>
</tr>
<tr>
<td>
2
</td>
<td>
1.017709
</td>
<td>
0.880817
</td>
<td>
00:00
</td>
</tr>
<tr>
<td>
3
</td>
<td>
0.798113
</td>
<td>
0.741172
</td>
<td>
00:00
</td>
</tr>
<tr>
<td>
4
</td>
<td>
0.688681
</td>
<td>
0.708689
</td>
<td>
00:00
</td>
</tr>
<tr>
<td>
5
</td>
<td>
0.648084
</td>
<td>
0.697439
</td>
<td>
00:00
</td>
</tr>
<tr>
<td>
6
</td>
<td>
0.631074
</td>
<td>
0.693731
</td>
<td>
00:00
</td>
</tr>
<tr>
<td>
7
</td>
<td>
0.608035
</td>
<td>
0.691561
</td>
<td>
00:00
</td>
</tr>
<tr>
<td>
8
</td>
<td>
0.609987
</td>
<td>
0.691219
</td>
<td>
00:00
</td>
</tr>
<tr>
<td>
9
</td>
<td>
0.607285
</td>
<td>
0.691045
</td>
<td>
00:00
</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceCode" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>learn.show_results()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="overflow-x:auto;">
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
</th>
<th>
userId
</th>
<th>
movieId
</th>
<th>
rating
</th>
<th>
rating_pred
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
63.0
</td>
<td>
48.0
</td>
<td>
5.0
</td>
<td>
2.935433
</td>
</tr>
<tr>
<th>
1
</th>
<td>
70.0
</td>
<td>
36.0
</td>
<td>
4.0
</td>
<td>
4.040259
</td>
</tr>
<tr>
<th>
2
</th>
<td>
65.0
</td>
<td>
92.0
</td>
<td>
4.5
</td>
<td>
4.266208
</td>
</tr>
<tr>
<th>
3
</th>
<td>
47.0
</td>
<td>
98.0
</td>
<td>
5.0
</td>
<td>
4.345912
</td>
</tr>
<tr>
<th>
4
</th>
<td>
4.0
</td>
<td>
83.0
</td>
<td>
3.5
</td>
<td>
4.335626
</td>
</tr>
<tr>
<th>
5
</th>
<td>
4.0
</td>
<td>
38.0
</td>
<td>
4.5
</td>
<td>
4.221953
</td>
</tr>
<tr>
<th>
6
</th>
<td>
59.0
</td>
<td>
60.0
</td>
<td>
5.0
</td>
<td>
4.432968
</td>
</tr>
<tr>
<th>
7
</th>
<td>
86.0
</td>
<td>
82.0
</td>
<td>
4.0
</td>
<td>
3.797124
</td>
</tr>
<tr>
<th>
8
</th>
<td>
55.0
</td>
<td>
86.0
</td>
<td>
4.5
</td>
<td>
3.959364
</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="validation-sets-and-test-sets" class="level2">
<h2 class="anchored" data-anchor-id="validation-sets-and-test-sets">Validation Sets and Test Sets</h2>
<ul>
<li>changes we make during the training process are influenced by the validation score
<ul>
<li>causes subsequent versions of the model to be indirectly shaped by the validation score</li>
</ul></li>
<li>test set
<ul>
<li>a set of data that we the model trainers do not look at until we are finished training the model</li>
<li>used to prevent us from over fitting our training process on the validation score</li>
<li>cannot be used to improve the model</li>
<li>especially useful when hiring a 3rd-party to train a model
<ul>
<li>keep a test set hidden from the 3rd-party and test and use it to evaluate the final model</li>
</ul></li>
</ul></li>
</ul>
<p>Use Judgment in Defining Test Sets</p>
<ul>
<li>the validation set and test set should be representative of the new data the model will encounter once deployed</li>
<li>a validation set for time series data should be a continuous section with the latest dates</li>
<li>determine if your model will need to handle examples that are qualitatively different from the training set</li>
</ul>
</section>
<section id="jargon" class="level2">
<h2 class="anchored" data-anchor-id="jargon">Jargon</h2>
<ul>
<li><p><strong>architecture</strong>: the functional form of a model</p>
<ul>
<li>people sometimes use model as a synonym for architecture</li>
</ul></li>
<li><p><strong>black box</strong>: something that gives predictions, but hides how it arrived at the prediction</p>
<ul>
<li>common misconception about deep learning models</li>
</ul></li>
<li><p><strong>classification model</strong>: attempts to predict a class or category</p>
<ul>
<li>does an image contain a cat or a dog</li>
</ul></li>
<li><p><strong>Convolutional Neural Network</strong>: a type of neural network that works particularly well for computer vision tasks</p></li>
<li><p><strong>epoch</strong></p>
<ul>
<li>one complete pass through the dataset</li>
</ul></li>
<li><p><strong>finetune</strong></p>
<ul>
<li>only update parts of a pretrained model when training it on a new task</li>
</ul></li>
<li><p><strong>hyperparameters</strong></p>
<ul>
<li>parameters about parameters</li>
<li>higher-level choices that govern the meaning of the weight parameters</li>
</ul></li>
<li><p><strong>independent variable</strong>: the data not including the labels</p></li>
<li><p><strong>loss</strong></p>
<ul>
<li><p>a measure of performance that is used by the training system to update the model weights</p></li>
<li><p>meant for machine consumption</p></li>
<li><p>depends on the predictions and correct labels</p></li>
</ul></li>
<li><p><strong>metric</strong></p>
<ul>
<li>a function that measures the quality of the model’s prediction using the validation set</li>
<li>mean for human consumption</li>
</ul></li>
<li><p><strong>model</strong>: the combination of an architecture with a particular set of parameters</p></li>
<li><p><strong>overfitting</strong></p>
<ul>
<li>a large enough model can memorize the training set when allowed to train for long enough</li>
<li>the single most important and challenging issue when training a model</li>
</ul></li>
<li><p><strong>predictions</strong>: output of the model</p>
<ul>
<li>predictions are calculated from the independent variable</li>
</ul></li>
<li><p><strong>pretrained model</strong></p>
<ul>
<li>a model that has weights which have already been trained on another dataset</li>
<li>should almost always use a pretrained model when available
<ul>
<li>reduces training time for the target dataset</li>
<li>reduces the amount of data needed for the new task</li>
</ul></li>
</ul></li>
<li><p><strong>regression model</strong>: attempts to predict one or more numeric quantities</p>
<ul>
<li>weather</li>
<li>location</li>
</ul></li>
<li><p><strong>test set</strong></p>
<ul>
<li>a set of data that we the model trainers do not look at until we are finished training the model</li>
<li>used to prevent us from over fitting our training process on the validation score</li>
<li>cannot be used to improve the model</li>
<li>especially useful when hiring a 3rd-party to train a model</li>
</ul></li>
<li><p><strong>validation set</strong>:</p>
<ul>
<li>used to measure the accuracy of the model during training</li>
<li>helps determine if the model is overfitting</li>
<li>important to measure model performance on data that is not used to update its weight values</li>
<li>we want our model to perform well on previously unseen data, not just the examples it was trained on</li>
</ul></li>
<li><p><strong>transfer learning</strong></p>
<ul>
<li>training a pre-trained model on a new dataset and task</li>
<li>removes the last layer of the pretrained model and replaces it with a new layer for the target dataset</li>
<li>last layer of the model is referred to as the head</li>
</ul></li>
<li><p><strong>weights</strong>: are often called parameters</p></li>
</ul>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li><a href="https://www.oreilly.com/library/view/deep-learning-for/9781492045519/">Deep Learning for Coders with fastai &amp; PyTorch</a></li>
<li><a href="https://github.com/fastai/fastbook">The fastai book GitHub Repository</a></li>
</ul>
<p><strong>Next:</strong> <a href="../chapter-2/">Notes on fastai Book Ch. 2</a></p>
<hr>
<div class="callout callout-style-default callout-tip callout-titled" title="About Me:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About Me:
</div>
</div>
<div class="callout-body-container callout-body">
<p>I’m Christian Mills, a deep learning consultant specializing in practical AI implementations. I help clients leverage cutting-edge AI technologies to solve real-world problems.</p>
<p>Interested in working together? Fill out my <a href="https://docs.google.com/forms/d/e/1FAIpQLScKDKPJF9Be47LA3nrEDXTVpzH2UMLz8SzHMHM9hWT5qlvjkw/viewform?usp=sf_link">Quick AI Project Assessment</a> form or learn more <a href="../../../about.html">about me</a>.</p>
</div>
</div>


</section>

</main> <!-- /main -->
<!-- Cloudflare Web Analytics --><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;56b8d2f624604c4891327b3c0d9f6703&quot;}"></script><!-- End Cloudflare Web Analytics -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/christianjmills\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="cj-mills/christianjmills" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<p>Content licensed under CC BY-NC-SA 4.0</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
<p>© 2024 Christian J. Mills</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://opensource.org/licenses/MIT">
<p>Code samples licensed under the MIT License</p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>