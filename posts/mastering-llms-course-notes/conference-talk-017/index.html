<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Christian Mills">
<meta name="dcterms.date" content="2024-08-29">
<meta name="description" content="In this talk, Simon Willison showcases LLM, a command-line tool for interacting with large language models, including how to leverage its plugin system, local model support, embedding capabilities, and integration with other Unix tools for tasks like retrieval augmented generation.">

<title>Conference Talk 17: Language Models on the Command-Line – Christian Mills</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Conference Talk 17: Language Models on the Command-Line – Christian Mills">
<meta property="og:description" content="In this talk, Simon Willison showcases LLM, a command-line tool for interacting with large language models, including how to leverage its plugin system, local model support, embedding capabilities, and integration with other Unix tools for tasks like retrieval augmented generation.">
<meta property="og:image" content="https://christianjmills.com/images/default-preview-image-black.png">
<meta property="og:site_name" content="Christian Mills">
<meta property="og:image:height" content="284">
<meta property="og:image:width" content="526">
<meta name="twitter:title" content="Conference Talk 17: Language Models on the Command-Line – Christian Mills">
<meta name="twitter:description" content="In this talk, Simon Willison showcases LLM, a command-line tool for interacting with large language models, including how to leverage its plugin system, local model support, embedding capabilities, and integration with other Unix tools for tasks like retrieval augmented generation.">
<meta name="twitter:image" content="https://christianjmills.com/images/default-preview-image-black.png">
<meta name="twitter:creator" content="@cdotjdotmills">
<meta name="twitter:site" content="@cdotjdotmills">
<meta name="twitter:image-height" content="284">
<meta name="twitter:image-width" content="526">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Christian Mills</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../series/tutorials/index.html"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../series/notes/index.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:christian@christianjmills.com"> <i class="bi bi-envelope-fill" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/cj-mills"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/cdotjdotmills"> <i class="bi bi-twitter-x" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/christianjmills"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#unix-command-line-a-perfect-llm-playground" id="toc-unix-command-line-a-perfect-llm-playground" class="nav-link" data-scroll-target="#unix-command-line-a-perfect-llm-playground">Unix Command Line: A Perfect LLM Playground</a></li>
  <li><a href="#installing-llm" id="toc-installing-llm" class="nav-link" data-scroll-target="#installing-llm">Installing LLM</a></li>
  <li><a href="#using-llm-with-openai" id="toc-using-llm-with-openai" class="nav-link" data-scroll-target="#using-llm-with-openai">Using LLM with OpenAI</a></li>
  <li><a href="#llm-plugins" id="toc-llm-plugins" class="nav-link" data-scroll-target="#llm-plugins">LLM Plugins</a></li>
  <li><a href="#llm-and-local-models" id="toc-llm-and-local-models" class="nav-link" data-scroll-target="#llm-and-local-models">LLM and Local Models</a></li>
  <li><a href="#command-line-scripts-with-llm" id="toc-command-line-scripts-with-llm" class="nav-link" data-scroll-target="#command-line-scripts-with-llm">Command Line Scripts with LLM</a></li>
  <li><a href="#llm-and-shotscraper-for-rag" id="toc-llm-and-shotscraper-for-rag" class="nav-link" data-scroll-target="#llm-and-shotscraper-for-rag">LLM and ShotScraper for RAG</a></li>
  <li><a href="#llm-and-embeddings" id="toc-llm-and-embeddings" class="nav-link" data-scroll-target="#llm-and-embeddings">LLM and Embeddings</a></li>
  <li><a href="#building-a-rag-system-with-llm" id="toc-building-a-rag-system-with-llm" class="nav-link" data-scroll-target="#building-a-rag-system-with-llm">Building a RAG System with LLM</a></li>
  <li><a href="#qa-highlights" id="toc-qa-highlights" class="nav-link" data-scroll-target="#qa-highlights">Q&amp;A Highlights</a>
  <ul>
  <li><a href="#hugging-face-hub-models" id="toc-hugging-face-hub-models" class="nav-link" data-scroll-target="#hugging-face-hub-models">Hugging Face Hub Models</a></li>
  <li><a href="#serverless-inference" id="toc-serverless-inference" class="nav-link" data-scroll-target="#serverless-inference">Serverless Inference</a></li>
  <li><a href="#agentic-workflows" id="toc-agentic-workflows" class="nav-link" data-scroll-target="#agentic-workflows">Agentic Workflows</a></li>
  <li><a href="#productivity-tips-from-simon-willison" id="toc-productivity-tips-from-simon-willison" class="nav-link" data-scroll-target="#productivity-tips-from-simon-willison">Productivity Tips from Simon Willison</a></li>
  <li><a href="#hardware-and-local-model-performance" id="toc-hardware-and-local-model-performance" class="nav-link" data-scroll-target="#hardware-and-local-model-performance">Hardware and Local Model Performance</a></li>
  <li><a href="#running-llm-on-iphones" id="toc-running-llm-on-iphones" class="nav-link" data-scroll-target="#running-llm-on-iphones">Running LLM on iPhones</a></li>
  <li><a href="#apples-approach-to-llms" id="toc-apples-approach-to-llms" class="nav-link" data-scroll-target="#apples-approach-to-llms">Apple’s Approach to LLMs</a></li>
  <li><a href="#value-of-running-local-llms" id="toc-value-of-running-local-llms" class="nav-link" data-scroll-target="#value-of-running-local-llms">Value of Running Local LLMs</a></li>
  <li><a href="#llm-evaluation-tool-in-development" id="toc-llm-evaluation-tool-in-development" class="nav-link" data-scroll-target="#llm-evaluation-tool-in-development">LLM Evaluation Tool (In Development)</a></li>
  <li><a href="#benchmarking-and-logging" id="toc-benchmarking-and-logging" class="nav-link" data-scroll-target="#benchmarking-and-logging">Benchmarking and Logging</a></li>
  <li><a href="#running-llm-on-multiple-machines" id="toc-running-llm-on-multiple-machines" class="nav-link" data-scroll-target="#running-llm-on-multiple-machines">Running LLM on Multiple Machines</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Conference Talk 17: Language Models on the Command-Line</h1>
  <div class="quarto-categories">
    <div class="quarto-category">notes</div>
    <div class="quarto-category">llms</div>
  </div>
  </div>

<div>
  <div class="description">
    In this talk, <strong>Simon Willison</strong> showcases <strong>LLM</strong>, a command-line tool for interacting with large language models, including how to leverage its plugin system, local model support, embedding capabilities, and integration with other Unix tools for tasks like retrieval augmented generation.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Christian Mills </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 29, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
This post is part of the following series:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="../../../series/notes/mastering-llms-course-notes.html"><strong>Mastering LLMs Course Notes</strong></a>: My notes from the course <strong>Mastering LLMs: A Conference For Developers &amp; Data Scientists</strong> by <strong>Hamel Husain</strong> and <strong>Dan Becker</strong>.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Presentation Resources">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Presentation Resources
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Talk Recording:</strong> <a href="https://www.youtube.com/watch?v=QUXQNi6jQ30">Language models on the command-line w/ Simon Willison</a></li>
<li><strong>Handout:</strong> <a href="https://github.com/simonw/language-models-on-the-command-line/blob/main/README.md">Language models on the command-line</a></li>
</ul>
</div>
</div>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<ul>
<li><strong><a href="https://simonwillison.net/">Simon Willison</a></strong>, creator of <a href="https://datasette.io/">Datasette</a>, Django co-creator, and PSF board member, presents a case for using Unix command line with LLMs.</li>
</ul>
</section>
<section id="unix-command-line-a-perfect-llm-playground" class="level3">
<h3 class="anchored" data-anchor-id="unix-command-line-a-perfect-llm-playground">Unix Command Line: A Perfect LLM Playground</h3>
<ul>
<li><strong>Unix Philosophy</strong>: Tools output information that gets piped into other tools as input.</li>
<li>LLMs function similarly: Prompt input generates responses that can be further processed.</li>
<li><strong>LLM Tool</strong>: A Python command line tool for interacting with LLMs.
<ul>
<li><strong>GitHub Repository:</strong> <a href="https://github.com/simonw/llm">https://github.com/simonw/llm</a></li>
<li><strong>Documentation:</strong> <a href="https://llm.datasette.io/en/stable/">https://llm.datasette.io/en/stable/</a></li>
</ul></li>
</ul>
</section>
<section id="installing-llm" class="level3">
<h3 class="anchored" data-anchor-id="installing-llm">Installing LLM</h3>
<ul>
<li><strong>Python Users</strong>: <code>pip install llm</code> (recommended: <code>pipx install llm</code>).</li>
<li><strong>Homebrew Users</strong>: <code>brew install llm</code>.</li>
</ul>
</section>
<section id="using-llm-with-openai" class="level3">
<h3 class="anchored" data-anchor-id="using-llm-with-openai">Using LLM with OpenAI</h3>
<ul>
<li><strong>Setting API Key</strong>:
<ul>
<li><code>llm keys set openAI &lt;your_api_key&gt;</code></li>
</ul></li>
<li><strong>Running Prompts</strong>:
<ul>
<li><code>llm "five great names for a pet pelican"</code></li>
</ul></li>
<li><strong>Saving Output</strong>:
<ul>
<li><code>llm "five great names for a pet pelican" &gt; pelicans.txt</code></li>
</ul></li>
<li><strong>Continuing Conversation</strong>:
<ul>
<li><code>llm -c "now do walruses"</code></li>
</ul></li>
<li><strong>Accessing Logs</strong>:
<ul>
<li><code>llm logs -c &lt;conversation_id&gt;</code> (e.g., to retrieve past responses)</li>
</ul></li>
<li><strong>Viewing Logs in <a href="https://datasette.io/">Datasette</a></strong>:
<ul>
<li><div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>  <span class="ex">pipx</span> install datasette</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><code>llm logs path</code> (provides path to SQLite database)</li>
<li><code>datasette "&lt;path_to_database&gt;"</code> (opens a web interface for browsing conversations).</li>
</ul></li>
<li><strong>Changing Default Model</strong>:
<ul>
<li><code>llm models default</code> (shows the current default model)</li>
<li><code>llm models default -m &lt;model_name&gt;</code> (sets a new default model, e.g., <code>chatGPT</code>).</li>
</ul></li>
</ul>
</section>
<section id="llm-plugins" class="level3">
<h3 class="anchored" data-anchor-id="llm-plugins">LLM Plugins</h3>
<ul>
<li><strong>Plugin Directory</strong>: <a href="https://llm.datasette.io/en/stable/plugins/directory.html">https://llm.datasette.io/en/stable/plugins/directory.html</a></li>
<li><strong>Plugin Types</strong>:
<ul>
<li><strong>Remote API Plugins</strong>: Connect to various LLM providers like Claude, Rekha, Perplexity, AnyScale.</li>
<li><strong>Local Model Plugins</strong>: Enable running models locally on your computer.</li>
</ul></li>
<li><strong>Installing Plugins</strong>:
<ul>
<li><code>llm install &lt;plugin_name&gt;</code> (e.g., <code>llm install llm-claude-3</code>)</li>
</ul></li>
<li><strong>Viewing Installed Plugins</strong>:
<ul>
<li><code>llm plugins</code></li>
</ul></li>
<li><strong>Using Plugin Aliases</strong>:
<ul>
<li><code>llm -m &lt;plugin_alias&gt;</code> (e.g., <code>llm -m haiku</code> to use <code>llm-claude-3-haiku</code>).</li>
</ul></li>
</ul>
</section>
<section id="llm-and-local-models" class="level3">
<h3 class="anchored" data-anchor-id="llm-and-local-models">LLM and Local Models</h3>
<ul>
<li><p><strong>Local Models</strong>: Increasingly effective and accessible through LLM plugins.</p></li>
<li><p><strong>LLM-GPT4all Plugin</strong>: Wrapper around nomic’s <a href="https://github.com/nomic-ai/gpt4all">gpt4all library</a>.</p>
<ul>
<li>Install: <code>llm install llm-gpt4all</code>.</li>
<li>List Models: <code>llm models</code> (includes installed local models).</li>
</ul></li>
<li><p><strong>Example</strong>: Running a local Mistral model:</p>
<ul>
<li><div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>  <span class="ex">llm</span> chat <span class="at">-m</span> mistral-7b-instruct-v0 <span class="st">"five great names for a pet seagull, explanations"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
<li><p><strong>LLM Chat</strong>: A command for persistent chat sessions with local models, avoids repeated loading.</p>
<ul>
<li><code>llm chat -m &lt;model_name&gt;</code> (e.g., <code>llm chat -m "mistral-7b"</code>)</li>
</ul></li>
<li><p><strong>Ollama Integration</strong>:</p>
<ul>
<li><strong><a href="https://ollama.com/">Ollama</a></strong>: A desktop app for managing and running local models.</li>
<li><strong>LLM-Olama Plugin</strong>: Allows using Ollama models within LLM.
<ul>
<li>Install: <code>llm install llm-olama</code>.</li>
<li>Access Ollama models: <code>llm models</code>.</li>
</ul></li>
<li>Example: Using Mixtral through Ollama:
<ul>
<li><code>llm chat -m "mixtral-latest" "Hola en español"</code></li>
</ul></li>
</ul></li>
<li><p><strong><a href="https://github.com/Mozilla-Ocho/llamafile">LlamaFile</a></strong>:</p>
<ul>
<li><strong>Functionality</strong>: A single binary containing both the LLM and the software to run it, compatible across multiple operating systems.</li>
<li><strong>Advantages</strong>: Downloadable, self-contained, acts as an offline backup.</li>
<li><strong>Example</strong>: Running Llama-370b:
<ul>
<li>Download the LlamaFile binary.</li>
<li>Make it executable: <code>chmod +x &lt;llamafile_binary&gt;</code>.</li>
<li>Run: <code>./&lt;llamafile_binary&gt;</code> (starts a web server for interaction).</li>
</ul></li>
<li><strong>LLM-LamaFile Plugin</strong>: Allows using LlamaFile models within LLM.
<ul>
<li>Install: <code>llm install llm-llamafile</code>.</li>
<li>Access LlamaFile models: <code>llm models</code>.</li>
</ul></li>
<li><strong>Lava Model</strong>: A notable LlamaFile model, recommended for its multi-modal capabilities.</li>
</ul></li>
</ul>
</section>
<section id="command-line-scripts-with-llm" class="level3">
<h3 class="anchored" data-anchor-id="command-line-scripts-with-llm">Command Line Scripts with LLM</h3>
<ul>
<li><strong><a href="https://til.simonwillison.net/llms/claude-hacker-news-themes">HN-Summary Script</a></strong>: Summarizes Hacker News posts and conversations using a combination of:
<ul>
<li><code>curl</code> to fetch data from the Hacker News API.</li>
<li><code>jq</code> to process the JSON output.</li>
<li><code>llm</code> with a system prompt to summarize the extracted text.</li>
</ul></li>
<li><strong><a href="https://simonwillison.net/2024/Apr/8/files-to-prompt/">Files-to-Prompt Command</a></strong>: Converts multiple files into a single prompt, including filenames and content.
<ul>
<li>Example: Using LLM to suggest tests for a project:
<ul>
<li><div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>  <span class="ex">files-to-prompt</span> <span class="op">&lt;</span>project_directory<span class="op">&gt;</span> <span class="kw">|</span> <span class="ex">llm</span> <span class="at">-s</span> <span class="st">"suggest tests to add to this project"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="llm-and-shotscraper-for-rag" class="level3">
<h3 class="anchored" data-anchor-id="llm-and-shotscraper-for-rag">LLM and ShotScraper for RAG</h3>
<ul>
<li><strong><a href="https://github.com/simonw/shot-scraper">ShotScraper Tool</a></strong>: A browser automation tool for taking screenshots and executing JavaScript from the command line.</li>
<li><strong>Scraping Google Search Results</strong>:
<ul>
<li>Example: Using ShotScraper and LLM to answer a question using Google search results:
<ul>
<li><div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>  <span class="ex">shot-scraper</span> javascript <span class="st">'https://www.google.com/search?q=nytimes+slop'</span> <span class="st">'</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="st">  Array.from(</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="st">    document.querySelectorAll("h3"),</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="st">    el =&gt; ({href: el.parentNode.href, title: el.innerText})</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="st">  )'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>  <span class="ex">shot-scraper</span> javascript <span class="st">'https://www.google.com/search?q=nytimes+slop'</span> <span class="st">'</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="st">  () =&gt; {</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="st">      function findParentWithHveid(element) {</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="st">          while (element &amp;&amp; !element.hasAttribute("data-hveid")) {</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="st">              element = element.parentElement;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="st">          }</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="st">          return element;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="st">      return Array.from(</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="st">          document.querySelectorAll("h3"),</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="st">          el =&gt; findParentWithHveid(el).innerText</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="st">      );</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span> <span class="kw">|</span> <span class="ex">llm</span> <span class="at">-s</span> <span class="st">'describe slop'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li>This script scrapes Google search results for “NY Times slop”, extracts relevant information using JavaScript, and pipes the results to LLM to answer the question “describe slop”.</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="llm-and-embeddings" class="level3">
<h3 class="anchored" data-anchor-id="llm-and-embeddings">LLM and Embeddings</h3>
<ul>
<li><p><strong>Embeddings</strong>: Supported through plugins, both API-based and local.</p></li>
<li><p><strong>Viewing Available Embedding Models</strong>:</p>
<ul>
<li><code>llm embed models</code>.</li>
</ul></li>
<li><p><strong>Creating Embeddings</strong>:</p>
<ul>
<li><code>llm embed -m &lt;model_name&gt; "&lt;text_to_embed&gt;"</code>.</li>
</ul></li>
<li><p><strong>Storing Embeddings in SQLite</strong>:</p>
<ul>
<li><strong><code>llm embed multi</code> Command</strong>: Creates a collection of embeddings and stores them in a SQLite database.</li>
<li>Example: Creating embeddings for bookmarks in a blog database:
<ul>
<li><div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>  <span class="ex">curl</span> <span class="at">-O</span> https://datasette.simonwillison.net/simonwillisonblog.db</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">llm</span> embed-multi links <span class="dt">\</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">-d</span> simonwillisonblog.db <span class="dt">\</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--sql</span> <span class="st">'select id, link_url, link_title, commentary from blog_blogmark'</span> <span class="dt">\</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">-m</span> 3-small <span class="at">--store</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li>This command creates a collection called “links”, embeds bookmarks from the specified database, uses the “text-embedding-ada-002” model, and stores both text and embeddings in the database.</li>
</ul></li>
</ul></li>
<li><p><strong>Searching with Embeddings</strong>:</p>
<ul>
<li><strong><code>llm similar</code> Command</strong>: Finds similar items in a collection based on embedding similarity.</li>
<li>Example: Searching for bookmarks related to “things that make me angry”:
<ul>
<li><div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>  <span class="ex">llm</span> similar links <span class="dt">\</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">-d</span> simonwillisonblog.db <span class="dt">\</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">-c</span> <span class="st">'things that make me angry'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
</ul></li>
<li><p><strong>Combining Embeddings and RAG</strong>:</p>
<ul>
<li>Example: Searching for data set plugins and summarizing the most interesting ones:
<ul>
<li><div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>  <span class="ex">llm</span> similar <span class="at">-c</span> links <span class="at">-d</span> <span class="op">&lt;</span>database_path<span class="op">&gt;</span> <span class="st">"datasette plugins"</span> <span class="kw">|</span> <span class="ex">llm</span> <span class="at">-s</span> <span class="st">"most interesting plugins"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="building-a-rag-system-with-llm" class="level3">
<h3 class="anchored" data-anchor-id="building-a-rag-system-with-llm">Building a RAG System with LLM</h3>
<ul>
<li><strong><code>blog-answer</code> Script</strong>: A bash script demonstrating a full RAG Q&amp;A workflow using:
<ul>
<li>Embedding search against paragraphs in a blog.</li>
<li>JQ for data processing.</li>
<li>A local LlamaFile model (or other models) for question answering.</li>
</ul></li>
<li><strong>Limitations of SQLite for Large Datasets</strong>:
<ul>
<li>Brute force search becomes inefficient for very large datasets.</li>
<li>Consider specialized vector indexes (SQLite-based or external like Pinecone) for better performance.</li>
</ul></li>
<li><strong>Future Goals</strong>:
<ul>
<li>Integrating support for external vector indexes within LLM.</li>
</ul></li>
<li><strong>Python API</strong>:
<ul>
<li><code>pip install llm</code> provides a Python API for accessing LLM functionalities.</li>
</ul></li>
</ul>
</section>
<section id="qa-highlights" class="level2">
<h2 class="anchored" data-anchor-id="qa-highlights">Q&amp;A Highlights</h2>
<section id="hugging-face-hub-models" class="level3">
<h3 class="anchored" data-anchor-id="hugging-face-hub-models">Hugging Face Hub Models</h3>
<ul>
<li><strong>No plugins currently exist for Hugging Face Hub models</strong> in LLM due to Simon’s lack of an NVIDIA GPU (required for most Hugging Face models).</li>
<li><strong>Opportunity for contribution</strong>: Anyone with an NVIDIA GPU is encouraged to write an LLM plugin for Hugging Face models.</li>
<li>Other serving technologies for Hugging Face models (e.g., vLLM) are also worth exploring.</li>
</ul>
</section>
<section id="serverless-inference" class="level3">
<h3 class="anchored" data-anchor-id="serverless-inference">Serverless Inference</h3>
<ul>
<li>LLM supports various <strong>API-based models</strong> through plugins (e.g., AnyScale, Fireworks, Open Router).</li>
<li><strong>OpenAI compatible models</strong> can be configured directly within LLM without writing plugins.</li>
<li><strong>Hugging Face Inference API</strong>: Potentially exciting opportunity for a new LLM plugin.</li>
</ul>
</section>
<section id="agentic-workflows" class="level3">
<h3 class="anchored" data-anchor-id="agentic-workflows">Agentic Workflows</h3>
<ul>
<li><strong>Not yet supported</strong> in LLM due to the lack of function calling functionality.</li>
<li><strong>Future plans</strong>: Function calling support and potential LLM agents plugin.</li>
<li><strong>Python API</strong>: Offers a way to access LLM functionalities from Python code, but the interface is still under development.</li>
</ul>
</section>
<section id="productivity-tips-from-simon-willison" class="level3">
<h3 class="anchored" data-anchor-id="productivity-tips-from-simon-willison">Productivity Tips from Simon Willison</h3>
<ul>
<li><strong>Blog Post:</strong> <a href="https://simonwillison.net/2022/Nov/26/productivity/">Coping strategies for the serial project hoarder</a></li>
<li><strong>Importance of Unit Tests and Documentation</strong>: Enables revisiting and continuing projects easily.</li>
<li><strong>Focus on Quick Projects</strong>: Leverage existing expertise to build cool things rapidly.</li>
<li><strong>GitHub Issues for Comprehensive Note-Taking</strong>: Use GitHub issues to document every step of a project, facilitating TIL writing and future reference.
<ul>
<li><strong>Example:</strong> <a href="https://github.com/simonw/public-notes/issues/1">Figure out how to serve an AWS Lambda function with a Function URL from a custom subdomain</a></li>
</ul></li>
</ul>
</section>
<section id="hardware-and-local-model-performance" class="level3">
<h3 class="anchored" data-anchor-id="hardware-and-local-model-performance">Hardware and Local Model Performance</h3>
<ul>
<li><strong>Simon’s Hardware</strong>: M2 Max with 64 GB RAM.</li>
<li><strong>Local Model Performance</strong>: Runs Mistral and other small models flawlessly, Llama-370b requires 40 GB RAM.</li>
<li><strong>Apple Silicon’s future</strong>: Potentially a powerful platform for running local models with the development of Apple’s MLX library.</li>
</ul>
</section>
<section id="running-llm-on-iphones" class="level3">
<h3 class="anchored" data-anchor-id="running-llm-on-iphones">Running LLM on iPhones</h3>
<ul>
<li><strong><a href="https://apps.apple.com/us/app/mlc-chat/id6448482937">MLC Chat App</a></strong>: Allows running Mistral directly on iPhones, enabling offline LLM access.</li>
</ul>
</section>
<section id="apples-approach-to-llms" class="level3">
<h3 class="anchored" data-anchor-id="apples-approach-to-llms">Apple’s Approach to LLMs</h3>
<ul>
<li><strong>Focused on specific features</strong>: Emphasizes using LLMs for functionalities like summarization and copy editing, avoiding the complexities of general chatbots.</li>
</ul>
</section>
<section id="value-of-running-local-llms" class="level3">
<h3 class="anchored" data-anchor-id="value-of-running-local-llms">Value of Running Local LLMs</h3>
<ul>
<li><strong>Exploration and Learning</strong>: Provides hands-on experience with different models, including less performant ones, which helps understand their strengths and weaknesses.</li>
<li><strong>Privacy</strong>: Keeps sensitive data on your local machine.</li>
<li><strong>Offline Access</strong>: Essential for situations without internet connectivity (e.g., flights, post-apocalyptic scenarios).</li>
</ul>
</section>
<section id="llm-evaluation-tool-in-development" class="level3">
<h3 class="anchored" data-anchor-id="llm-evaluation-tool-in-development">LLM Evaluation Tool (In Development)</h3>
<ul>
<li><strong>Goals</strong>:
<ul>
<li>Record evaluation results in SQLite.</li>
<li>Build an interface for comparing model responses and collecting human feedback (similar to <a href="https://lmarena.ai/">LM Arena</a>).</li>
</ul></li>
<li><strong>Advantages of SQLite</strong>:
<ul>
<li>Fast, free, universally available.</li>
<li>Works as a portable file format for sharing evaluation data.</li>
</ul></li>
</ul>
</section>
<section id="benchmarking-and-logging" class="level3">
<h3 class="anchored" data-anchor-id="benchmarking-and-logging">Benchmarking and Logging</h3>
<ul>
<li><strong>Planned Feature</strong>: Log latency, token count, and duration of LLM operations in the SQLite database.</li>
<li><strong>Challenges</strong>: Determining token counts for models that don’t provide this information.</li>
</ul>
</section>
<section id="running-llm-on-multiple-machines" class="level3">
<h3 class="anchored" data-anchor-id="running-llm-on-multiple-machines">Running LLM on Multiple Machines</h3>
<ul>
<li><strong>Solution</strong>: Leverage existing tools like <a href="https://www.ansible.com/">Ansible</a> to run LLM commands in parallel on different machines within a LAN.</li>
<li><strong>Unix Flexibility</strong>: Highlights the ability to combine LLM with other Unix tools for customized workflows and automation.</li>
</ul>
<hr>
<div class="callout callout-style-default callout-tip callout-titled" title="About Me:">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About Me:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>I’m Christian Mills, a deep learning consultant specializing in computer vision and practical AI implementations.</li>
<li>I help clients leverage cutting-edge AI technologies to solve real-world problems.</li>
<li>Learn more <a href="../../../about.html">about me</a> or reach out via email at <a href="mailto:christian@christianjmills.com">christian@christianjmills.com</a> to discuss your project.</li>
</ul>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<!-- Cloudflare Web Analytics --><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;56b8d2f624604c4891327b3c0d9f6703&quot;}"></script><!-- End Cloudflare Web Analytics -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/christianjmills\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="cj-mills/christianjmills" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<p>Content licensed under CC BY-NC-SA 4.0</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
<p>© 2024 Christian J. Mills</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://opensource.org/licenses/MIT">
<p>Code samples licensed under the MIT License</p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>